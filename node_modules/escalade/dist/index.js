const{dirname:dirname,resolve:resolve}=require("path"),{readdir:readdir,stat:stat}=require("fs"),{promisify:promisify}=require("util"),toStats=promisify(stat),toRead=promisify(readdir);module.exports=async function(r,e){let i,t=resolve(".",r);for((await toStats(t)).isDirectory()||(t=dirname(t));;){if(i=await e(t,await toRead(t)),i)return resolve(t,i);if(t=dirname(i=t),i===t)break}};