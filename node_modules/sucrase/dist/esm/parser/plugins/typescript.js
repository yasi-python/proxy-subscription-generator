import{eat,finishToken,IdentifierRole,lookaheadType,lookaheadTypeAndKeyword,match,next,nextTemplateToken,popTypeContext,pushTypeContext,rescan_gt}from"../tokenizer/index";import{ContextualKeyword}from"../tokenizer/keywords";import{TokenType,TokenType as tt}from"../tokenizer/types";import{isJSXEnabled,state}from"../traverser/base";import{atPossibleAsync,baseParseMaybeAssign,baseParseSubscript,parseCallExpressionArguments,parseExprAtom,parseExpression,parseFunctionBody,parseIdentifier,parseLiteral,parseMaybeAssign,parseMaybeUnary,parsePropertyName,parseTemplate}from"../traverser/expression";import{parseBindingIdentifier,parseBindingList,parseImportedIdentifier}from"../traverser/lval";import{baseParseMaybeDecoratorArguments,parseBlockBody,parseClass,parseFunction,parseFunctionParams,parseStatement,parseVarStatement}from"../traverser/statement";import{canInsertSemicolon,eatContextual,expect,expectContextual,hasPrecedingLineBreak,isContextual,isLineTerminator,isLookaheadContextual,semicolon,unexpected}from"../traverser/util";import{nextJSXTagToken}from"./jsx";function tsIsIdentifier(){return match(tt.name)}function isLiteralPropertyName(){return match(tt.name)||Boolean(state.type&TokenType.IS_KEYWORD)||match(tt.string)||match(tt.num)||match(tt.bigint)||match(tt.decimal)}function tsNextTokenCanFollowModifier(){const t=state.snapshot();return next(),!(!(match(tt.bracketL)||match(tt.braceL)||match(tt.star)||match(tt.ellipsis)||match(tt.hash)||isLiteralPropertyName())||hasPrecedingLineBreak())||(state.restoreFromSnapshot(t),!1)}export function tsParseModifiers(t){for(;null!==tsParseModifier(t););}export function tsParseModifier(t){if(!match(tt.name))return null;const e=state.contextualKeyword;if(-1!==t.indexOf(e)&&tsNextTokenCanFollowModifier()){switch(e){case ContextualKeyword._readonly:state.tokens[state.tokens.length-1].type=tt._readonly;break;case ContextualKeyword._abstract:state.tokens[state.tokens.length-1].type=tt._abstract;break;case ContextualKeyword._static:state.tokens[state.tokens.length-1].type=tt._static;break;case ContextualKeyword._public:state.tokens[state.tokens.length-1].type=tt._public;break;case ContextualKeyword._private:state.tokens[state.tokens.length-1].type=tt._private;break;case ContextualKeyword._protected:state.tokens[state.tokens.length-1].type=tt._protected;break;case ContextualKeyword._override:state.tokens[state.tokens.length-1].type=tt._override;break;case ContextualKeyword._declare:state.tokens[state.tokens.length-1].type=tt._declare}return e}return null}function tsParseEntityName(){for(parseIdentifier();eat(tt.dot);)parseIdentifier()}function tsParseTypeReference(){tsParseEntityName(),!hasPrecedingLineBreak()&&match(tt.lessThan)&&tsParseTypeArguments()}function tsParseThisTypePredicate(){next(),tsParseTypeAnnotation()}function tsParseThisTypeNode(){next()}function tsParseTypeQuery(){expect(tt._typeof),match(tt._import)?tsParseImportType():tsParseEntityName(),!hasPrecedingLineBreak()&&match(tt.lessThan)&&tsParseTypeArguments()}function tsParseImportType(){expect(tt._import),expect(tt.parenL),expect(tt.string),expect(tt.parenR),eat(tt.dot)&&tsParseEntityName(),match(tt.lessThan)&&tsParseTypeArguments()}function tsParseTypeParameter(){eat(tt._const);const t=eat(tt._in),e=eatContextual(ContextualKeyword._out);eat(tt._const),!t&&!e||match(tt.name)?parseIdentifier():state.tokens[state.tokens.length-1].type=tt.name,eat(tt._extends)&&tsParseType(),eat(tt.eq)&&tsParseType()}export function tsTryParseTypeParameters(){match(tt.lessThan)&&tsParseTypeParameters()}function tsParseTypeParameters(){const t=pushTypeContext(0);for(match(tt.lessThan)||match(tt.typeParameterStart)?next():unexpected();!eat(tt.greaterThan)&&!state.error;)tsParseTypeParameter(),eat(tt.comma);popTypeContext(t)}function tsFillSignature(t){const e=t===tt.arrow;tsTryParseTypeParameters(),expect(tt.parenL),state.scopeDepth++,tsParseBindingListForSignature(!1),state.scopeDepth--,(e||match(t))&&tsParseTypeOrTypePredicateAnnotation(t)}function tsParseBindingListForSignature(t){parseBindingList(tt.parenR,t)}function tsParseTypeMemberSemicolon(){eat(tt.comma)||semicolon()}function tsParseSignatureMember(){tsFillSignature(tt.colon),tsParseTypeMemberSemicolon()}function tsIsUnambiguouslyIndexSignature(){const t=state.snapshot();next();const e=eat(tt.name)&&match(tt.colon);return state.restoreFromSnapshot(t),e}function tsTryParseIndexSignature(){if(!match(tt.bracketL)||!tsIsUnambiguouslyIndexSignature())return!1;const t=pushTypeContext(0);return expect(tt.bracketL),parseIdentifier(),tsParseTypeAnnotation(),expect(tt.bracketR),tsTryParseTypeAnnotation(),tsParseTypeMemberSemicolon(),popTypeContext(t),!0}function tsParsePropertyOrMethodSignature(t){eat(tt.question),t||!match(tt.parenL)&&!match(tt.lessThan)?(tsTryParseTypeAnnotation(),tsParseTypeMemberSemicolon()):(tsFillSignature(tt.colon),tsParseTypeMemberSemicolon())}function tsParseTypeMember(){if(match(tt.parenL)||match(tt.lessThan))return void tsParseSignatureMember();if(match(tt._new))return next(),void(match(tt.parenL)||match(tt.lessThan)?tsParseSignatureMember():tsParsePropertyOrMethodSignature(!1));const t=!!tsParseModifier([ContextualKeyword._readonly]);tsTryParseIndexSignature()||((isContextual(ContextualKeyword._get)||isContextual(ContextualKeyword._set))&&tsNextTokenCanFollowModifier(),parsePropertyName(-1),tsParsePropertyOrMethodSignature(t))}function tsParseTypeLiteral(){tsParseObjectTypeMembers()}function tsParseObjectTypeMembers(){for(expect(tt.braceL);!eat(tt.braceR)&&!state.error;)tsParseTypeMember()}function tsLookaheadIsStartOfMappedType(){const t=state.snapshot(),e=tsIsStartOfMappedType();return state.restoreFromSnapshot(t),e}function tsIsStartOfMappedType(){return next(),eat(tt.plus)||eat(tt.minus)?isContextual(ContextualKeyword._readonly):(isContextual(ContextualKeyword._readonly)&&next(),!!match(tt.bracketL)&&(next(),!!tsIsIdentifier()&&(next(),match(tt._in))))}function tsParseMappedTypeParameter(){parseIdentifier(),expect(tt._in),tsParseType()}function tsParseMappedType(){expect(tt.braceL),match(tt.plus)||match(tt.minus)?(next(),expectContextual(ContextualKeyword._readonly)):eatContextual(ContextualKeyword._readonly),expect(tt.bracketL),tsParseMappedTypeParameter(),eatContextual(ContextualKeyword._as)&&tsParseType(),expect(tt.bracketR),match(tt.plus)||match(tt.minus)?(next(),expect(tt.question)):eat(tt.question),tsTryParseType(),semicolon(),expect(tt.braceR)}function tsParseTupleType(){for(expect(tt.bracketL);!eat(tt.bracketR)&&!state.error;)tsParseTupleElementType(),eat(tt.comma)}function tsParseTupleElementType(){eat(tt.ellipsis)?tsParseType():(tsParseType(),eat(tt.question)),eat(tt.colon)&&tsParseType()}function tsParseParenthesizedType(){expect(tt.parenL),tsParseType(),expect(tt.parenR)}function tsParseTemplateLiteralType(){for(nextTemplateToken(),nextTemplateToken();!match(tt.backQuote)&&!state.error;)expect(tt.dollarBraceL),tsParseType(),nextTemplateToken(),nextTemplateToken();next()}var FunctionType;function tsParseFunctionOrConstructorType(t){t===FunctionType.TSAbstractConstructorType&&expectContextual(ContextualKeyword._abstract),t!==FunctionType.TSConstructorType&&t!==FunctionType.TSAbstractConstructorType||expect(tt._new);const e=state.inDisallowConditionalTypesContext;state.inDisallowConditionalTypesContext=!1,tsFillSignature(tt.arrow),state.inDisallowConditionalTypesContext=e}function tsParseNonArrayType(){switch(state.type){case tt.name:return void tsParseTypeReference();case tt._void:case tt._null:return void next();case tt.string:case tt.num:case tt.bigint:case tt.decimal:case tt._true:case tt._false:return void parseLiteral();case tt.minus:return next(),void parseLiteral();case tt._this:return tsParseThisTypeNode(),void(isContextual(ContextualKeyword._is)&&!hasPrecedingLineBreak()&&tsParseThisTypePredicate());case tt._typeof:return void tsParseTypeQuery();case tt._import:return void tsParseImportType();case tt.braceL:return void(tsLookaheadIsStartOfMappedType()?tsParseMappedType():tsParseTypeLiteral());case tt.bracketL:return void tsParseTupleType();case tt.parenL:return void tsParseParenthesizedType();case tt.backQuote:return void tsParseTemplateLiteralType();default:if(state.type&TokenType.IS_KEYWORD)return next(),void(state.tokens[state.tokens.length-1].type=tt.name)}unexpected()}function tsParseArrayTypeOrHigher(){for(tsParseNonArrayType();!hasPrecedingLineBreak()&&eat(tt.bracketL);)eat(tt.bracketR)||(tsParseType(),expect(tt.bracketR))}function tsParseInferType(){if(expectContextual(ContextualKeyword._infer),parseIdentifier(),match(tt._extends)){const t=state.snapshot();expect(tt._extends);const e=state.inDisallowConditionalTypesContext;state.inDisallowConditionalTypesContext=!0,tsParseType(),state.inDisallowConditionalTypesContext=e,(state.error||!state.inDisallowConditionalTypesContext&&match(tt.question))&&state.restoreFromSnapshot(t)}}function tsParseTypeOperatorOrHigher(){if(isContextual(ContextualKeyword._keyof)||isContextual(ContextualKeyword._unique)||isContextual(ContextualKeyword._readonly))next(),tsParseTypeOperatorOrHigher();else if(isContextual(ContextualKeyword._infer))tsParseInferType();else{const t=state.inDisallowConditionalTypesContext;state.inDisallowConditionalTypesContext=!1,tsParseArrayTypeOrHigher(),state.inDisallowConditionalTypesContext=t}}function tsParseIntersectionTypeOrHigher(){if(eat(tt.bitwiseAND),tsParseTypeOperatorOrHigher(),match(tt.bitwiseAND))for(;eat(tt.bitwiseAND);)tsParseTypeOperatorOrHigher()}function tsParseUnionTypeOrHigher(){if(eat(tt.bitwiseOR),tsParseIntersectionTypeOrHigher(),match(tt.bitwiseOR))for(;eat(tt.bitwiseOR);)tsParseIntersectionTypeOrHigher()}function tsIsStartOfFunctionType(){return!!match(tt.lessThan)||match(tt.parenL)&&tsLookaheadIsUnambiguouslyStartOfFunctionType()}function tsSkipParameterStart(){if(match(tt.name)||match(tt._this))return next(),!0;if(match(tt.braceL)||match(tt.bracketL)){let t=1;for(next();t>0&&!state.error;)match(tt.braceL)||match(tt.bracketL)?t++:(match(tt.braceR)||match(tt.bracketR))&&t--,next();return!0}return!1}function tsLookaheadIsUnambiguouslyStartOfFunctionType(){const t=state.snapshot(),e=tsIsUnambiguouslyStartOfFunctionType();return state.restoreFromSnapshot(t),e}function tsIsUnambiguouslyStartOfFunctionType(){if(next(),match(tt.parenR)||match(tt.ellipsis))return!0;if(tsSkipParameterStart()){if(match(tt.colon)||match(tt.comma)||match(tt.question)||match(tt.eq))return!0;if(match(tt.parenR)&&(next(),match(tt.arrow)))return!0}return!1}function tsParseTypeOrTypePredicateAnnotation(t){const e=pushTypeContext(0);expect(t),tsParseTypePredicateOrAssertsPrefix()||tsParseType(),popTypeContext(e)}function tsTryParseTypeOrTypePredicateAnnotation(){match(tt.colon)&&tsParseTypeOrTypePredicateAnnotation(tt.colon)}!function(t){t[t.TSFunctionType=0]="TSFunctionType",t[t.TSConstructorType=1]="TSConstructorType",t[t.TSAbstractConstructorType=2]="TSAbstractConstructorType"}(FunctionType||(FunctionType={}));export function tsTryParseTypeAnnotation(){match(tt.colon)&&tsParseTypeAnnotation()}function tsTryParseType(){eat(tt.colon)&&tsParseType()}function tsParseTypePredicateOrAssertsPrefix(){const t=state.snapshot();return isContextual(ContextualKeyword._asserts)?(next(),eatContextual(ContextualKeyword._is)?(tsParseType(),!0):tsIsIdentifier()||match(tt._this)?(next(),eatContextual(ContextualKeyword._is)&&tsParseType(),!0):(state.restoreFromSnapshot(t),!1)):!(!tsIsIdentifier()&&!match(tt._this)||(next(),isContextual(ContextualKeyword._is)&&!hasPrecedingLineBreak()?(next(),tsParseType(),0):(state.restoreFromSnapshot(t),1)))}export function tsParseTypeAnnotation(){const t=pushTypeContext(0);expect(tt.colon),tsParseType(),popTypeContext(t)}export function tsParseType(){if(tsParseNonConditionalType(),state.inDisallowConditionalTypesContext||hasPrecedingLineBreak()||!eat(tt._extends))return;const t=state.inDisallowConditionalTypesContext;state.inDisallowConditionalTypesContext=!0,tsParseNonConditionalType(),state.inDisallowConditionalTypesContext=t,expect(tt.question),tsParseType(),expect(tt.colon),tsParseType()}function isAbstractConstructorSignature(){return isContextual(ContextualKeyword._abstract)&&lookaheadType()===tt._new}export function tsParseNonConditionalType(){tsIsStartOfFunctionType()?tsParseFunctionOrConstructorType(FunctionType.TSFunctionType):match(tt._new)?tsParseFunctionOrConstructorType(FunctionType.TSConstructorType):isAbstractConstructorSignature()?tsParseFunctionOrConstructorType(FunctionType.TSAbstractConstructorType):tsParseUnionTypeOrHigher()}export function tsParseTypeAssertion(){const t=pushTypeContext(1);tsParseType(),expect(tt.greaterThan),popTypeContext(t),parseMaybeUnary()}export function tsTryParseJSXTypeArgument(){if(eat(tt.jsxTagStart)){state.tokens[state.tokens.length-1].type=tt.typeParameterStart;const t=pushTypeContext(1);for(;!match(tt.greaterThan)&&!state.error;)tsParseType(),eat(tt.comma);nextJSXTagToken(),popTypeContext(t)}}function tsParseHeritageClause(){for(;!match(tt.braceL)&&!state.error;)tsParseExpressionWithTypeArguments(),eat(tt.comma)}function tsParseExpressionWithTypeArguments(){tsParseEntityName(),match(tt.lessThan)&&tsParseTypeArguments()}function tsParseInterfaceDeclaration(){parseBindingIdentifier(!1),tsTryParseTypeParameters(),eat(tt._extends)&&tsParseHeritageClause(),tsParseObjectTypeMembers()}function tsParseTypeAliasDeclaration(){parseBindingIdentifier(!1),tsTryParseTypeParameters(),expect(tt.eq),tsParseType(),semicolon()}function tsParseEnumMember(){if(match(tt.string)?parseLiteral():parseIdentifier(),eat(tt.eq)){const t=state.tokens.length-1;parseMaybeAssign(),state.tokens[t].rhsEndIndex=state.tokens.length}}function tsParseEnumDeclaration(){for(parseBindingIdentifier(!1),expect(tt.braceL);!eat(tt.braceR)&&!state.error;)tsParseEnumMember(),eat(tt.comma)}function tsParseModuleBlock(){expect(tt.braceL),parseBlockBody(tt.braceR)}function tsParseModuleOrNamespaceDeclaration(){parseBindingIdentifier(!1),eat(tt.dot)?tsParseModuleOrNamespaceDeclaration():tsParseModuleBlock()}function tsParseAmbientExternalModuleDeclaration(){isContextual(ContextualKeyword._global)?parseIdentifier():match(tt.string)?parseExprAtom():unexpected(),match(tt.braceL)?tsParseModuleBlock():semicolon()}export function tsParseImportEqualsDeclaration(){parseImportedIdentifier(),expect(tt.eq),tsParseModuleReference(),semicolon()}function tsIsExternalModuleReference(){return isContextual(ContextualKeyword._require)&&lookaheadType()===tt.parenL}function tsParseModuleReference(){tsIsExternalModuleReference()?tsParseExternalModuleReference():tsParseEntityName()}function tsParseExternalModuleReference(){expectContextual(ContextualKeyword._require),expect(tt.parenL),match(tt.string)||unexpected(),parseLiteral(),expect(tt.parenR)}function tsTryParseDeclare(){if(isLineTerminator())return!1;switch(state.type){case tt._function:{const t=pushTypeContext(1);next();const e=state.start;return parseFunction(e,!0),popTypeContext(t),!0}case tt._class:{const t=pushTypeContext(1);return parseClass(!0,!1),popTypeContext(t),!0}case tt._const:if(match(tt._const)&&isLookaheadContextual(ContextualKeyword._enum)){const t=pushTypeContext(1);return expect(tt._const),expectContextual(ContextualKeyword._enum),state.tokens[state.tokens.length-1].type=tt._enum,tsParseEnumDeclaration(),popTypeContext(t),!0}case tt._var:case tt._let:{const t=pushTypeContext(1);return parseVarStatement(state.type!==tt._var),popTypeContext(t),!0}case tt.name:{const t=pushTypeContext(1),e=state.contextualKeyword;let a=!1;return e===ContextualKeyword._global?(tsParseAmbientExternalModuleDeclaration(),a=!0):a=tsParseDeclaration(e,!0),popTypeContext(t),a}default:return!1}}function tsTryParseExportDeclaration(){return tsParseDeclaration(state.contextualKeyword,!0)}function tsParseExpressionStatement(t){switch(t){case ContextualKeyword._declare:{const t=state.tokens.length-1;if(tsTryParseDeclare())return state.tokens[t].type=tt._declare,!0;break}case ContextualKeyword._global:if(match(tt.braceL))return tsParseModuleBlock(),!0;break;default:return tsParseDeclaration(t,!1)}return!1}function tsParseDeclaration(t,e){switch(t){case ContextualKeyword._abstract:if(tsCheckLineTerminator(e)&&match(tt._class))return state.tokens[state.tokens.length-1].type=tt._abstract,parseClass(!0,!1),!0;break;case ContextualKeyword._enum:if(tsCheckLineTerminator(e)&&match(tt.name))return state.tokens[state.tokens.length-1].type=tt._enum,tsParseEnumDeclaration(),!0;break;case ContextualKeyword._interface:if(tsCheckLineTerminator(e)&&match(tt.name)){const t=pushTypeContext(e?2:1);return tsParseInterfaceDeclaration(),popTypeContext(t),!0}break;case ContextualKeyword._module:if(tsCheckLineTerminator(e)){if(match(tt.string)){const t=pushTypeContext(e?2:1);return tsParseAmbientExternalModuleDeclaration(),popTypeContext(t),!0}if(match(tt.name)){const t=pushTypeContext(e?2:1);return tsParseModuleOrNamespaceDeclaration(),popTypeContext(t),!0}}break;case ContextualKeyword._namespace:if(tsCheckLineTerminator(e)&&match(tt.name)){const t=pushTypeContext(e?2:1);return tsParseModuleOrNamespaceDeclaration(),popTypeContext(t),!0}break;case ContextualKeyword._type:if(tsCheckLineTerminator(e)&&match(tt.name)){const t=pushTypeContext(e?2:1);return tsParseTypeAliasDeclaration(),popTypeContext(t),!0}}return!1}function tsCheckLineTerminator(t){return t?(next(),!0):!isLineTerminator()}function tsTryParseGenericAsyncArrowFunction(){const t=state.snapshot();return tsParseTypeParameters(),parseFunctionParams(),tsTryParseTypeOrTypePredicateAnnotation(),expect(tt.arrow),state.error?(state.restoreFromSnapshot(t),!1):(parseFunctionBody(!0),!0)}function tsParseTypeArgumentsWithPossibleBitshift(){state.type===tt.bitShiftL&&(state.pos-=1,finishToken(tt.lessThan)),tsParseTypeArguments()}function tsParseTypeArguments(){const t=pushTypeContext(0);for(expect(tt.lessThan);!match(tt.greaterThan)&&!state.error;)tsParseType(),eat(tt.comma);t?(expect(tt.greaterThan),popTypeContext(t)):(popTypeContext(t),rescan_gt(),expect(tt.greaterThan),state.tokens[state.tokens.length-1].isType=!0)}export function tsIsDeclarationStart(){if(match(tt.name))switch(state.contextualKeyword){case ContextualKeyword._abstract:case ContextualKeyword._declare:case ContextualKeyword._enum:case ContextualKeyword._interface:case ContextualKeyword._module:case ContextualKeyword._namespace:case ContextualKeyword._type:return!0}return!1}export function tsParseFunctionBodyAndFinish(t,e){if(match(tt.colon)&&tsParseTypeOrTypePredicateAnnotation(tt.colon),!match(tt.braceL)&&isLineTerminator()){let e=state.tokens.length-1;for(;e>=0&&(state.tokens[e].start>=t||state.tokens[e].type===tt._default||state.tokens[e].type===tt._export);)state.tokens[e].isType=!0,e--;return}parseFunctionBody(!1,e)}export function tsParseSubscript(t,e,a){if(hasPrecedingLineBreak()||!eat(tt.bang)){if(match(tt.lessThan)||match(tt.bitShiftL)){const a=state.snapshot();if(!e&&atPossibleAsync()&&tsTryParseGenericAsyncArrowFunction())return;if(tsParseTypeArgumentsWithPossibleBitshift(),!e&&eat(tt.parenL)?(state.tokens[state.tokens.length-1].subscriptStartIndex=t,parseCallExpressionArguments()):match(tt.backQuote)?parseTemplate():(state.type===tt.greaterThan||state.type!==tt.parenL&&Boolean(state.type&TokenType.IS_EXPRESSION_START)&&!hasPrecedingLineBreak())&&unexpected(),!state.error)return;state.restoreFromSnapshot(a)}else!e&&match(tt.questionDot)&&lookaheadType()===tt.lessThan&&(next(),state.tokens[t].isOptionalChainStart=!0,state.tokens[state.tokens.length-1].subscriptStartIndex=t,tsParseTypeArguments(),expect(tt.parenL),parseCallExpressionArguments());baseParseSubscript(t,e,a)}else state.tokens[state.tokens.length-1].type=tt.nonNullAssertion}export function tsTryParseExport(){if(eat(tt._import))return isContextual(ContextualKeyword._type)&&lookaheadType()!==tt.eq&&expectContextual(ContextualKeyword._type),tsParseImportEqualsDeclaration(),!0;if(eat(tt.eq))return parseExpression(),semicolon(),!0;if(eatContextual(ContextualKeyword._as))return expectContextual(ContextualKeyword._namespace),parseIdentifier(),semicolon(),!0;if(isContextual(ContextualKeyword._type)){const t=lookaheadType();t!==tt.braceL&&t!==tt.star||next()}return!1}export function tsParseImportSpecifier(){if(parseIdentifier(),match(tt.comma)||match(tt.braceR))state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ImportDeclaration;else{if(parseIdentifier(),match(tt.comma)||match(tt.braceR))return state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ImportDeclaration,state.tokens[state.tokens.length-2].isType=!0,void(state.tokens[state.tokens.length-1].isType=!0);if(parseIdentifier(),match(tt.comma)||match(tt.braceR))return state.tokens[state.tokens.length-3].identifierRole=IdentifierRole.ImportAccess,void(state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ImportDeclaration);parseIdentifier(),state.tokens[state.tokens.length-3].identifierRole=IdentifierRole.ImportAccess,state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ImportDeclaration,state.tokens[state.tokens.length-4].isType=!0,state.tokens[state.tokens.length-3].isType=!0,state.tokens[state.tokens.length-2].isType=!0,state.tokens[state.tokens.length-1].isType=!0}}export function tsParseExportSpecifier(){if(parseIdentifier(),match(tt.comma)||match(tt.braceR))state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ExportAccess;else{if(parseIdentifier(),match(tt.comma)||match(tt.braceR))return state.tokens[state.tokens.length-1].identifierRole=IdentifierRole.ExportAccess,state.tokens[state.tokens.length-2].isType=!0,void(state.tokens[state.tokens.length-1].isType=!0);parseIdentifier(),match(tt.comma)||match(tt.braceR)?state.tokens[state.tokens.length-3].identifierRole=IdentifierRole.ExportAccess:(parseIdentifier(),state.tokens[state.tokens.length-3].identifierRole=IdentifierRole.ExportAccess,state.tokens[state.tokens.length-4].isType=!0,state.tokens[state.tokens.length-3].isType=!0,state.tokens[state.tokens.length-2].isType=!0,state.tokens[state.tokens.length-1].isType=!0)}}export function tsTryParseExportDefaultExpression(){if(isContextual(ContextualKeyword._abstract)&&lookaheadType()===tt._class)return state.type=tt._abstract,next(),parseClass(!0,!0),!0;if(isContextual(ContextualKeyword._interface)){const t=pushTypeContext(2);return tsParseDeclaration(ContextualKeyword._interface,!0),popTypeContext(t),!0}return!1}export function tsTryParseStatementContent(){if(state.type===tt._const){const t=lookaheadTypeAndKeyword();if(t.type===tt.name&&t.contextualKeyword===ContextualKeyword._enum)return expect(tt._const),expectContextual(ContextualKeyword._enum),state.tokens[state.tokens.length-1].type=tt._enum,tsParseEnumDeclaration(),!0}return!1}export function tsTryParseClassMemberWithIsStatic(t){const e=state.tokens.length;tsParseModifiers([ContextualKeyword._abstract,ContextualKeyword._readonly,ContextualKeyword._declare,ContextualKeyword._static,ContextualKeyword._override]);const a=state.tokens.length;if(tsTryParseIndexSignature()){for(let s=t?e-1:e;s<a;s++)state.tokens[s].isType=!0;return!0}return!1}export function tsParseIdentifierStatement(t){tsParseExpressionStatement(t)||semicolon()}export function tsParseExportDeclaration(){const t=eatContextual(ContextualKeyword._declare);t&&(state.tokens[state.tokens.length-1].type=tt._declare);let e=!1;if(match(tt.name))if(t){const t=pushTypeContext(2);e=tsTryParseExportDeclaration(),popTypeContext(t)}else e=tsTryParseExportDeclaration();if(!e)if(t){const t=pushTypeContext(2);parseStatement(!0),popTypeContext(t)}else parseStatement(!0)}export function tsAfterParseClassSuper(t){if(t&&(match(tt.lessThan)||match(tt.bitShiftL))&&tsParseTypeArgumentsWithPossibleBitshift(),eatContextual(ContextualKeyword._implements)){state.tokens[state.tokens.length-1].type=tt._implements;const t=pushTypeContext(1);tsParseHeritageClause(),popTypeContext(t)}}export function tsStartParseObjPropValue(){tsTryParseTypeParameters()}export function tsStartParseFunctionParams(){tsTryParseTypeParameters()}export function tsAfterParseVarHead(){const t=pushTypeContext(0);hasPrecedingLineBreak()||eat(tt.bang),tsTryParseTypeAnnotation(),popTypeContext(t)}export function tsStartParseAsyncArrowFromCallExpression(){match(tt.colon)&&tsParseTypeAnnotation()}export function tsParseMaybeAssign(t,e){return isJSXEnabled?tsParseMaybeAssignWithJSX(t,e):tsParseMaybeAssignWithoutJSX(t,e)}export function tsParseMaybeAssignWithJSX(t,e){if(!match(tt.lessThan))return baseParseMaybeAssign(t,e);const a=state.snapshot();let s=baseParseMaybeAssign(t,e);return state.error?(state.restoreFromSnapshot(a),state.type=tt.typeParameterStart,tsParseTypeParameters(),s=baseParseMaybeAssign(t,e),s||unexpected(),s):s}export function tsParseMaybeAssignWithoutJSX(t,e){if(!match(tt.lessThan))return baseParseMaybeAssign(t,e);const a=state.snapshot();tsParseTypeParameters();const s=baseParseMaybeAssign(t,e);return s||unexpected(),state.error?(state.restoreFromSnapshot(a),baseParseMaybeAssign(t,e)):s}export function tsParseArrow(){if(match(tt.colon)){const t=state.snapshot();tsParseTypeOrTypePredicateAnnotation(tt.colon),canInsertSemicolon()&&unexpected(),match(tt.arrow)||unexpected(),state.error&&state.restoreFromSnapshot(t)}return eat(tt.arrow)}export function tsParseAssignableListItemTypes(){const t=pushTypeContext(0);eat(tt.question),tsTryParseTypeAnnotation(),popTypeContext(t)}export function tsParseMaybeDecoratorArguments(){(match(tt.lessThan)||match(tt.bitShiftL))&&tsParseTypeArgumentsWithPossibleBitshift(),baseParseMaybeDecoratorArguments()}