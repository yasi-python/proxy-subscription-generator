"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _index=require("../index"),_flow=require("../plugins/flow"),_typescript=require("../plugins/typescript"),_tokenizer=require("../tokenizer"),_keywords=require("../tokenizer/keywords"),_state=require("../tokenizer/state"),_types=require("../tokenizer/types"),_charcodes=require("../util/charcodes"),_base=require("./base"),_expression=require("./expression"),_lval=require("./lval"),_util=require("./util");function parseTopLevel(){if(parseBlockBody(_types.TokenType.eof),_base.state.scopes.push(new(0,_state.Scope)(0,_base.state.tokens.length,!0)),0!==_base.state.scopeDepth)throw new Error(`Invalid scope depth at end of file: ${_base.state.scopeDepth}`);return new(0,_index.File)(_base.state.tokens,_base.state.scopes)}function parseStatement(e){_base.isFlowEnabled&&_flow.flowTryParseStatement.call(void 0)||(_tokenizer.match.call(void 0,_types.TokenType.at)&&parseDecorators(),parseStatementContent(e))}function parseStatementContent(e){if(_base.isTypeScriptEnabled&&_typescript.tsTryParseStatementContent.call(void 0))return;const t=_base.state.type;switch(t){case _types.TokenType._break:case _types.TokenType._continue:return void parseBreakContinueStatement();case _types.TokenType._debugger:return void parseDebuggerStatement();case _types.TokenType._do:return void parseDoStatement();case _types.TokenType._for:return void parseForStatement();case _types.TokenType._function:if(_tokenizer.lookaheadType.call(void 0)===_types.TokenType.dot)break;return e||_util.unexpected.call(void 0),void parseFunctionStatement();case _types.TokenType._class:return e||_util.unexpected.call(void 0),void parseClass(!0);case _types.TokenType._if:return void parseIfStatement();case _types.TokenType._return:return void parseReturnStatement();case _types.TokenType._switch:return void parseSwitchStatement();case _types.TokenType._throw:return void parseThrowStatement();case _types.TokenType._try:return void parseTryStatement();case _types.TokenType._let:case _types.TokenType._const:e||_util.unexpected.call(void 0);case _types.TokenType._var:return void parseVarStatement(t!==_types.TokenType._var);case _types.TokenType._while:return void parseWhileStatement();case _types.TokenType.braceL:return void parseBlock();case _types.TokenType.semi:return void parseEmptyStatement();case _types.TokenType._export:case _types.TokenType._import:{const e=_tokenizer.lookaheadType.call(void 0);if(e===_types.TokenType.parenL||e===_types.TokenType.dot)break;return _tokenizer.next.call(void 0),void(t===_types.TokenType._import?parseImport():parseExport())}case _types.TokenType.name:if(_base.state.contextualKeyword===_keywords.ContextualKeyword._async){const e=_base.state.start,t=_base.state.snapshot();if(_tokenizer.next.call(void 0),_tokenizer.match.call(void 0,_types.TokenType._function)&&!_util.canInsertSemicolon.call(void 0))return _util.expect.call(void 0,_types.TokenType._function),void parseFunction(e,!0);_base.state.restoreFromSnapshot(t)}else{if(_base.state.contextualKeyword===_keywords.ContextualKeyword._using&&!_util.hasFollowingLineBreak.call(void 0)&&_tokenizer.lookaheadType.call(void 0)===_types.TokenType.name)return void parseVarStatement(!0);if(startsAwaitUsing())return _util.expectContextual.call(void 0,_keywords.ContextualKeyword._await),void parseVarStatement(!0)}}const a=_base.state.tokens.length;_expression.parseExpression.call(void 0);let o=null;if(_base.state.tokens.length===a+1){const e=_base.state.tokens[_base.state.tokens.length-1];e.type===_types.TokenType.name&&(o=e.contextualKeyword)}null!=o?_tokenizer.eat.call(void 0,_types.TokenType.colon)?parseLabeledStatement():parseIdentifierStatement(o):_util.semicolon.call(void 0)}function startsAwaitUsing(){if(!_util.isContextual.call(void 0,_keywords.ContextualKeyword._await))return!1;const e=_base.state.snapshot();return _tokenizer.next.call(void 0),!_util.isContextual.call(void 0,_keywords.ContextualKeyword._using)||_util.hasPrecedingLineBreak.call(void 0)?(_base.state.restoreFromSnapshot(e),!1):(_tokenizer.next.call(void 0),!_tokenizer.match.call(void 0,_types.TokenType.name)||_util.hasPrecedingLineBreak.call(void 0)?(_base.state.restoreFromSnapshot(e),!1):(_base.state.restoreFromSnapshot(e),!0))}function parseDecorators(){for(;_tokenizer.match.call(void 0,_types.TokenType.at);)parseDecorator()}function parseDecorator(){if(_tokenizer.next.call(void 0),_tokenizer.eat.call(void 0,_types.TokenType.parenL))_expression.parseExpression.call(void 0),_util.expect.call(void 0,_types.TokenType.parenR);else{for(_expression.parseIdentifier.call(void 0);_tokenizer.eat.call(void 0,_types.TokenType.dot);)_expression.parseIdentifier.call(void 0);parseMaybeDecoratorArguments()}}function parseMaybeDecoratorArguments(){_base.isTypeScriptEnabled?_typescript.tsParseMaybeDecoratorArguments.call(void 0):baseParseMaybeDecoratorArguments()}function baseParseMaybeDecoratorArguments(){_tokenizer.eat.call(void 0,_types.TokenType.parenL)&&_expression.parseCallExpressionArguments.call(void 0)}function parseBreakContinueStatement(){_tokenizer.next.call(void 0),_util.isLineTerminator.call(void 0)||(_expression.parseIdentifier.call(void 0),_util.semicolon.call(void 0))}function parseDebuggerStatement(){_tokenizer.next.call(void 0),_util.semicolon.call(void 0)}function parseDoStatement(){_tokenizer.next.call(void 0),parseStatement(!1),_util.expect.call(void 0,_types.TokenType._while),_expression.parseParenExpression.call(void 0),_tokenizer.eat.call(void 0,_types.TokenType.semi)}function parseForStatement(){_base.state.scopeDepth++;const e=_base.state.tokens.length;parseAmbiguousForStatement();const t=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(e,t,!1)),_base.state.scopeDepth--}function isUsingInLoop(){return!!_util.isContextual.call(void 0,_keywords.ContextualKeyword._using)&&!_util.isLookaheadContextual.call(void 0,_keywords.ContextualKeyword._of)}function parseAmbiguousForStatement(){_tokenizer.next.call(void 0);let e=!1;if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._await)&&(e=!0,_tokenizer.next.call(void 0)),_util.expect.call(void 0,_types.TokenType.parenL),_tokenizer.match.call(void 0,_types.TokenType.semi))return e&&_util.unexpected.call(void 0),void parseFor();const t=startsAwaitUsing();if(t||_tokenizer.match.call(void 0,_types.TokenType._var)||_tokenizer.match.call(void 0,_types.TokenType._let)||_tokenizer.match.call(void 0,_types.TokenType._const)||isUsingInLoop())return t&&_util.expectContextual.call(void 0,_keywords.ContextualKeyword._await),_tokenizer.next.call(void 0),parseVar(!0,_base.state.type!==_types.TokenType._var),_tokenizer.match.call(void 0,_types.TokenType._in)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._of)?void parseForIn(e):void parseFor();_expression.parseExpression.call(void 0,!0),_tokenizer.match.call(void 0,_types.TokenType._in)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._of)?parseForIn(e):(e&&_util.unexpected.call(void 0),parseFor())}function parseFunctionStatement(){const e=_base.state.start;_tokenizer.next.call(void 0),parseFunction(e,!0)}function parseIfStatement(){_tokenizer.next.call(void 0),_expression.parseParenExpression.call(void 0),parseStatement(!1),_tokenizer.eat.call(void 0,_types.TokenType._else)&&parseStatement(!1)}function parseReturnStatement(){_tokenizer.next.call(void 0),_util.isLineTerminator.call(void 0)||(_expression.parseExpression.call(void 0),_util.semicolon.call(void 0))}function parseSwitchStatement(){_tokenizer.next.call(void 0),_expression.parseParenExpression.call(void 0),_base.state.scopeDepth++;const e=_base.state.tokens.length;for(_util.expect.call(void 0,_types.TokenType.braceL);!_tokenizer.match.call(void 0,_types.TokenType.braceR)&&!_base.state.error;)if(_tokenizer.match.call(void 0,_types.TokenType._case)||_tokenizer.match.call(void 0,_types.TokenType._default)){const e=_tokenizer.match.call(void 0,_types.TokenType._case);_tokenizer.next.call(void 0),e&&_expression.parseExpression.call(void 0),_util.expect.call(void 0,_types.TokenType.colon)}else parseStatement(!0);_tokenizer.next.call(void 0);const t=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(e,t,!1)),_base.state.scopeDepth--}function parseThrowStatement(){_tokenizer.next.call(void 0),_expression.parseExpression.call(void 0),_util.semicolon.call(void 0)}function parseCatchClauseParam(){_lval.parseBindingAtom.call(void 0,!0),_base.isTypeScriptEnabled&&_typescript.tsTryParseTypeAnnotation.call(void 0)}function parseTryStatement(){if(_tokenizer.next.call(void 0),parseBlock(),_tokenizer.match.call(void 0,_types.TokenType._catch)){_tokenizer.next.call(void 0);let e=null;if(_tokenizer.match.call(void 0,_types.TokenType.parenL)&&(_base.state.scopeDepth++,e=_base.state.tokens.length,_util.expect.call(void 0,_types.TokenType.parenL),parseCatchClauseParam(),_util.expect.call(void 0,_types.TokenType.parenR)),parseBlock(),null!=e){const t=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(e,t,!1)),_base.state.scopeDepth--}}_tokenizer.eat.call(void 0,_types.TokenType._finally)&&parseBlock()}function parseVarStatement(e){_tokenizer.next.call(void 0),parseVar(!1,e),_util.semicolon.call(void 0)}function parseWhileStatement(){_tokenizer.next.call(void 0),_expression.parseParenExpression.call(void 0),parseStatement(!1)}function parseEmptyStatement(){_tokenizer.next.call(void 0)}function parseLabeledStatement(){parseStatement(!0)}function parseIdentifierStatement(e){_base.isTypeScriptEnabled?_typescript.tsParseIdentifierStatement.call(void 0,e):_base.isFlowEnabled?_flow.flowParseIdentifierStatement.call(void 0,e):_util.semicolon.call(void 0)}function parseBlock(e=!1,t=0){const a=_base.state.tokens.length;_base.state.scopeDepth++,_util.expect.call(void 0,_types.TokenType.braceL),t&&(_base.state.tokens[_base.state.tokens.length-1].contextId=t),parseBlockBody(_types.TokenType.braceR),t&&(_base.state.tokens[_base.state.tokens.length-1].contextId=t);const o=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(a,o,e)),_base.state.scopeDepth--}function parseBlockBody(e){for(;!_tokenizer.eat.call(void 0,e)&&!_base.state.error;)parseStatement(!0)}function parseFor(){_util.expect.call(void 0,_types.TokenType.semi),_tokenizer.match.call(void 0,_types.TokenType.semi)||_expression.parseExpression.call(void 0),_util.expect.call(void 0,_types.TokenType.semi),_tokenizer.match.call(void 0,_types.TokenType.parenR)||_expression.parseExpression.call(void 0),_util.expect.call(void 0,_types.TokenType.parenR),parseStatement(!1)}function parseForIn(e){e?_util.eatContextual.call(void 0,_keywords.ContextualKeyword._of):_tokenizer.next.call(void 0),_expression.parseExpression.call(void 0),_util.expect.call(void 0,_types.TokenType.parenR),parseStatement(!1)}function parseVar(e,t){for(;;){if(parseVarHead(t),_tokenizer.eat.call(void 0,_types.TokenType.eq)){const t=_base.state.tokens.length-1;_expression.parseMaybeAssign.call(void 0,e),_base.state.tokens[t].rhsEndIndex=_base.state.tokens.length}if(!_tokenizer.eat.call(void 0,_types.TokenType.comma))break}}function parseVarHead(e){_lval.parseBindingAtom.call(void 0,e),_base.isTypeScriptEnabled?_typescript.tsAfterParseVarHead.call(void 0):_base.isFlowEnabled&&_flow.flowAfterParseVarHead.call(void 0)}function parseFunction(e,t,a=!1){_tokenizer.match.call(void 0,_types.TokenType.star)&&_tokenizer.next.call(void 0),!t||a||_tokenizer.match.call(void 0,_types.TokenType.name)||_tokenizer.match.call(void 0,_types.TokenType._yield)||_util.unexpected.call(void 0);let o=null;_tokenizer.match.call(void 0,_types.TokenType.name)&&(t||(o=_base.state.tokens.length,_base.state.scopeDepth++),_lval.parseBindingIdentifier.call(void 0,!1));const s=_base.state.tokens.length;_base.state.scopeDepth++,parseFunctionParams(),_expression.parseFunctionBodyAndFinish.call(void 0,e);const r=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(s,r,!0)),_base.state.scopeDepth--,null!==o&&(_base.state.scopes.push(new(0,_state.Scope)(o,r,!0)),_base.state.scopeDepth--)}function parseFunctionParams(e=!1,t=0){_base.isTypeScriptEnabled?_typescript.tsStartParseFunctionParams.call(void 0):_base.isFlowEnabled&&_flow.flowStartParseFunctionParams.call(void 0),_util.expect.call(void 0,_types.TokenType.parenL),t&&(_base.state.tokens[_base.state.tokens.length-1].contextId=t),_lval.parseBindingList.call(void 0,_types.TokenType.parenR,!1,!1,e,t),t&&(_base.state.tokens[_base.state.tokens.length-1].contextId=t)}function parseClass(e,t=!1){const a=_base.getNextContextId.call(void 0);_tokenizer.next.call(void 0),_base.state.tokens[_base.state.tokens.length-1].contextId=a,_base.state.tokens[_base.state.tokens.length-1].isExpression=!e;let o=null;e||(o=_base.state.tokens.length,_base.state.scopeDepth++),parseClassId(e,t),parseClassSuper();const s=_base.state.tokens.length;if(parseClassBody(a),!_base.state.error&&(_base.state.tokens[s].contextId=a,_base.state.tokens[_base.state.tokens.length-1].contextId=a,null!==o)){const e=_base.state.tokens.length;_base.state.scopes.push(new(0,_state.Scope)(o,e,!1)),_base.state.scopeDepth--}}function isClassProperty(){return _tokenizer.match.call(void 0,_types.TokenType.eq)||_tokenizer.match.call(void 0,_types.TokenType.semi)||_tokenizer.match.call(void 0,_types.TokenType.braceR)||_tokenizer.match.call(void 0,_types.TokenType.bang)||_tokenizer.match.call(void 0,_types.TokenType.colon)}function isClassMethod(){return _tokenizer.match.call(void 0,_types.TokenType.parenL)||_tokenizer.match.call(void 0,_types.TokenType.lessThan)}function parseClassBody(e){for(_util.expect.call(void 0,_types.TokenType.braceL);!_tokenizer.eat.call(void 0,_types.TokenType.braceR)&&!_base.state.error;){if(_tokenizer.eat.call(void 0,_types.TokenType.semi))continue;if(_tokenizer.match.call(void 0,_types.TokenType.at)){parseDecorator();continue}parseClassMember(_base.state.start,e)}}function parseClassMember(e,t){_base.isTypeScriptEnabled&&_typescript.tsParseModifiers.call(void 0,[_keywords.ContextualKeyword._declare,_keywords.ContextualKeyword._public,_keywords.ContextualKeyword._protected,_keywords.ContextualKeyword._private,_keywords.ContextualKeyword._override]);let a=!1;if(_tokenizer.match.call(void 0,_types.TokenType.name)&&_base.state.contextualKeyword===_keywords.ContextualKeyword._static){if(_expression.parseIdentifier.call(void 0),isClassMethod())return void parseClassMethod(e,!1);if(isClassProperty())return void parseClassProperty();if(_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._static,a=!0,_tokenizer.match.call(void 0,_types.TokenType.braceL))return _base.state.tokens[_base.state.tokens.length-1].contextId=t,void parseBlock()}parseClassMemberWithIsStatic(e,a,t)}function parseClassMemberWithIsStatic(e,t,a){if(_base.isTypeScriptEnabled&&_typescript.tsTryParseClassMemberWithIsStatic.call(void 0,t))return;if(_tokenizer.eat.call(void 0,_types.TokenType.star))return parseClassPropertyName(a),void parseClassMethod(e,!1);parseClassPropertyName(a);let o=!1;const s=_base.state.tokens[_base.state.tokens.length-1];if(s.contextualKeyword===_keywords.ContextualKeyword._constructor&&(o=!0),parsePostMemberNameModifiers(),isClassMethod())parseClassMethod(e,o);else if(isClassProperty())parseClassProperty();else if(s.contextualKeyword!==_keywords.ContextualKeyword._async||_util.isLineTerminator.call(void 0))s.contextualKeyword!==_keywords.ContextualKeyword._get&&s.contextualKeyword!==_keywords.ContextualKeyword._set||_util.isLineTerminator.call(void 0)&&_tokenizer.match.call(void 0,_types.TokenType.star)?s.contextualKeyword!==_keywords.ContextualKeyword._accessor||_util.isLineTerminator.call(void 0)?_util.isLineTerminator.call(void 0)?parseClassProperty():_util.unexpected.call(void 0):(parseClassPropertyName(a),parseClassProperty()):(s.contextualKeyword===_keywords.ContextualKeyword._get?_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._get:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._set,parseClassPropertyName(a),parseClassMethod(e,!1));else{_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._async;_tokenizer.match.call(void 0,_types.TokenType.star)&&_tokenizer.next.call(void 0),parseClassPropertyName(a),parsePostMemberNameModifiers(),parseClassMethod(e,!1)}}function parseClassMethod(e,t){_base.isTypeScriptEnabled?_typescript.tsTryParseTypeParameters.call(void 0):_base.isFlowEnabled&&_tokenizer.match.call(void 0,_types.TokenType.lessThan)&&_flow.flowParseTypeParameterDeclaration.call(void 0),_expression.parseMethod.call(void 0,e,t)}function parseClassPropertyName(e){_expression.parsePropertyName.call(void 0,e)}function parsePostMemberNameModifiers(){if(_base.isTypeScriptEnabled){const e=_tokenizer.pushTypeContext.call(void 0,0);_tokenizer.eat.call(void 0,_types.TokenType.question),_tokenizer.popTypeContext.call(void 0,e)}}function parseClassProperty(){if(_base.isTypeScriptEnabled?(_tokenizer.eatTypeToken.call(void 0,_types.TokenType.bang),_typescript.tsTryParseTypeAnnotation.call(void 0)):_base.isFlowEnabled&&_tokenizer.match.call(void 0,_types.TokenType.colon)&&_flow.flowParseTypeAnnotation.call(void 0),_tokenizer.match.call(void 0,_types.TokenType.eq)){const e=_base.state.tokens.length;_tokenizer.next.call(void 0),_expression.parseMaybeAssign.call(void 0),_base.state.tokens[e].rhsEndIndex=_base.state.tokens.length}_util.semicolon.call(void 0)}function parseClassId(e,t=!1){_base.isTypeScriptEnabled&&(!e||t)&&_util.isContextual.call(void 0,_keywords.ContextualKeyword._implements)||(_tokenizer.match.call(void 0,_types.TokenType.name)&&_lval.parseBindingIdentifier.call(void 0,!0),_base.isTypeScriptEnabled?_typescript.tsTryParseTypeParameters.call(void 0):_base.isFlowEnabled&&_tokenizer.match.call(void 0,_types.TokenType.lessThan)&&_flow.flowParseTypeParameterDeclaration.call(void 0))}function parseClassSuper(){let e=!1;_tokenizer.eat.call(void 0,_types.TokenType._extends)?(_expression.parseExprSubscripts.call(void 0),e=!0):e=!1,_base.isTypeScriptEnabled?_typescript.tsAfterParseClassSuper.call(void 0,e):_base.isFlowEnabled&&_flow.flowAfterParseClassSuper.call(void 0,e)}function parseExport(){const e=_base.state.tokens.length-1;_base.isTypeScriptEnabled&&_typescript.tsTryParseExport.call(void 0)||(shouldParseExportStar()?parseExportStar():isExportDefaultSpecifier()?(_expression.parseIdentifier.call(void 0),_tokenizer.match.call(void 0,_types.TokenType.comma)&&_tokenizer.lookaheadType.call(void 0)===_types.TokenType.star?(_util.expect.call(void 0,_types.TokenType.comma),_util.expect.call(void 0,_types.TokenType.star),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._as),_expression.parseIdentifier.call(void 0)):parseExportSpecifiersMaybe(),parseExportFrom()):_tokenizer.eat.call(void 0,_types.TokenType._default)?parseExportDefaultExpression():shouldParseExportDeclaration()?parseExportDeclaration():(parseExportSpecifiers(),parseExportFrom()),_base.state.tokens[e].rhsEndIndex=_base.state.tokens.length)}function parseExportDefaultExpression(){if(_base.isTypeScriptEnabled&&_typescript.tsTryParseExportDefaultExpression.call(void 0))return;if(_base.isFlowEnabled&&_flow.flowTryParseExportDefaultExpression.call(void 0))return;const e=_base.state.start;_tokenizer.eat.call(void 0,_types.TokenType._function)?parseFunction(e,!0,!0):_util.isContextual.call(void 0,_keywords.ContextualKeyword._async)&&_tokenizer.lookaheadType.call(void 0)===_types.TokenType._function?(_util.eatContextual.call(void 0,_keywords.ContextualKeyword._async),_tokenizer.eat.call(void 0,_types.TokenType._function),parseFunction(e,!0,!0)):_tokenizer.match.call(void 0,_types.TokenType._class)?parseClass(!0,!0):_tokenizer.match.call(void 0,_types.TokenType.at)?(parseDecorators(),parseClass(!0,!0)):(_expression.parseMaybeAssign.call(void 0),_util.semicolon.call(void 0))}function parseExportDeclaration(){_base.isTypeScriptEnabled?_typescript.tsParseExportDeclaration.call(void 0):_base.isFlowEnabled?_flow.flowParseExportDeclaration.call(void 0):parseStatement(!0)}function isExportDefaultSpecifier(){if(_base.isTypeScriptEnabled&&_typescript.tsIsDeclarationStart.call(void 0))return!1;if(_base.isFlowEnabled&&_flow.flowShouldDisallowExportDefaultSpecifier.call(void 0))return!1;if(_tokenizer.match.call(void 0,_types.TokenType.name))return _base.state.contextualKeyword!==_keywords.ContextualKeyword._async;if(!_tokenizer.match.call(void 0,_types.TokenType._default))return!1;const e=_tokenizer.nextTokenStart.call(void 0),t=_tokenizer.lookaheadTypeAndKeyword.call(void 0),a=t.type===_types.TokenType.name&&t.contextualKeyword===_keywords.ContextualKeyword._from;if(t.type===_types.TokenType.comma)return!0;if(a){const t=_base.input.charCodeAt(_tokenizer.nextTokenStartSince.call(void 0,e+4));return t===_charcodes.charCodes.quotationMark||t===_charcodes.charCodes.apostrophe}return!1}function parseExportSpecifiersMaybe(){_tokenizer.eat.call(void 0,_types.TokenType.comma)&&parseExportSpecifiers()}function parseExportFrom(){_util.eatContextual.call(void 0,_keywords.ContextualKeyword._from)&&(_expression.parseExprAtom.call(void 0),maybeParseImportAttributes()),_util.semicolon.call(void 0)}function shouldParseExportStar(){return _base.isFlowEnabled?_flow.flowShouldParseExportStar.call(void 0):_tokenizer.match.call(void 0,_types.TokenType.star)}function parseExportStar(){_base.isFlowEnabled?_flow.flowParseExportStar.call(void 0):baseParseExportStar()}function baseParseExportStar(){_util.expect.call(void 0,_types.TokenType.star),_util.isContextual.call(void 0,_keywords.ContextualKeyword._as)?parseExportNamespace():parseExportFrom()}function parseExportNamespace(){_tokenizer.next.call(void 0),_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._as,_expression.parseIdentifier.call(void 0),parseExportSpecifiersMaybe(),parseExportFrom()}function shouldParseExportDeclaration(){return _base.isTypeScriptEnabled&&_typescript.tsIsDeclarationStart.call(void 0)||_base.isFlowEnabled&&_flow.flowShouldParseExportDeclaration.call(void 0)||_base.state.type===_types.TokenType._var||_base.state.type===_types.TokenType._const||_base.state.type===_types.TokenType._let||_base.state.type===_types.TokenType._function||_base.state.type===_types.TokenType._class||_util.isContextual.call(void 0,_keywords.ContextualKeyword._async)||_tokenizer.match.call(void 0,_types.TokenType.at)}function parseExportSpecifiers(){let e=!0;for(_util.expect.call(void 0,_types.TokenType.braceL);!_tokenizer.eat.call(void 0,_types.TokenType.braceR)&&!_base.state.error;){if(e)e=!1;else if(_util.expect.call(void 0,_types.TokenType.comma),_tokenizer.eat.call(void 0,_types.TokenType.braceR))break;parseExportSpecifier()}}function parseExportSpecifier(){_base.isTypeScriptEnabled?_typescript.tsParseExportSpecifier.call(void 0):(_expression.parseIdentifier.call(void 0),_base.state.tokens[_base.state.tokens.length-1].identifierRole=_tokenizer.IdentifierRole.ExportAccess,_util.eatContextual.call(void 0,_keywords.ContextualKeyword._as)&&_expression.parseIdentifier.call(void 0))}function isImportReflection(){const e=_base.state.snapshot();return _util.expectContextual.call(void 0,_keywords.ContextualKeyword._module),_util.eatContextual.call(void 0,_keywords.ContextualKeyword._from)?_util.isContextual.call(void 0,_keywords.ContextualKeyword._from)?(_base.state.restoreFromSnapshot(e),!0):(_base.state.restoreFromSnapshot(e),!1):_tokenizer.match.call(void 0,_types.TokenType.comma)?(_base.state.restoreFromSnapshot(e),!1):(_base.state.restoreFromSnapshot(e),!0)}function parseMaybeImportReflection(){_util.isContextual.call(void 0,_keywords.ContextualKeyword._module)&&isImportReflection()&&_tokenizer.next.call(void 0)}function parseImport(){if(_base.isTypeScriptEnabled&&_tokenizer.match.call(void 0,_types.TokenType.name)&&_tokenizer.lookaheadType.call(void 0)===_types.TokenType.eq)_typescript.tsParseImportEqualsDeclaration.call(void 0);else{if(_base.isTypeScriptEnabled&&_util.isContextual.call(void 0,_keywords.ContextualKeyword._type)){const e=_tokenizer.lookaheadTypeAndKeyword.call(void 0);if(e.type===_types.TokenType.name&&e.contextualKeyword!==_keywords.ContextualKeyword._from){if(_util.expectContextual.call(void 0,_keywords.ContextualKeyword._type),_tokenizer.lookaheadType.call(void 0)===_types.TokenType.eq)return void _typescript.tsParseImportEqualsDeclaration.call(void 0)}else e.type!==_types.TokenType.star&&e.type!==_types.TokenType.braceL||_util.expectContextual.call(void 0,_keywords.ContextualKeyword._type)}_tokenizer.match.call(void 0,_types.TokenType.string)||(parseMaybeImportReflection(),parseImportSpecifiers(),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._from)),_expression.parseExprAtom.call(void 0),maybeParseImportAttributes(),_util.semicolon.call(void 0)}}function shouldParseDefaultImport(){return _tokenizer.match.call(void 0,_types.TokenType.name)}function parseImportSpecifierLocal(){_lval.parseImportedIdentifier.call(void 0)}function parseImportSpecifiers(){_base.isFlowEnabled&&_flow.flowStartParseImportSpecifiers.call(void 0);let e=!0;if(!shouldParseDefaultImport()||(parseImportSpecifierLocal(),_tokenizer.eat.call(void 0,_types.TokenType.comma))){if(_tokenizer.match.call(void 0,_types.TokenType.star))return _tokenizer.next.call(void 0),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._as),void parseImportSpecifierLocal();for(_util.expect.call(void 0,_types.TokenType.braceL);!_tokenizer.eat.call(void 0,_types.TokenType.braceR)&&!_base.state.error;){if(e)e=!1;else if(_tokenizer.eat.call(void 0,_types.TokenType.colon)&&_util.unexpected.call(void 0,"ES2015 named imports do not destructure. Use another statement for destructuring after the import."),_util.expect.call(void 0,_types.TokenType.comma),_tokenizer.eat.call(void 0,_types.TokenType.braceR))break;parseImportSpecifier()}}}function parseImportSpecifier(){_base.isTypeScriptEnabled?_typescript.tsParseImportSpecifier.call(void 0):_base.isFlowEnabled?_flow.flowParseImportSpecifier.call(void 0):(_lval.parseImportedIdentifier.call(void 0),_util.isContextual.call(void 0,_keywords.ContextualKeyword._as)&&(_base.state.tokens[_base.state.tokens.length-1].identifierRole=_tokenizer.IdentifierRole.ImportAccess,_tokenizer.next.call(void 0),_lval.parseImportedIdentifier.call(void 0)))}function maybeParseImportAttributes(){(_tokenizer.match.call(void 0,_types.TokenType._with)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._assert)&&!_util.hasPrecedingLineBreak.call(void 0))&&(_tokenizer.next.call(void 0),_expression.parseObj.call(void 0,!1,!1))}exports.parseTopLevel=parseTopLevel,exports.parseStatement=parseStatement,exports.parseDecorators=parseDecorators,exports.baseParseMaybeDecoratorArguments=baseParseMaybeDecoratorArguments,exports.parseVarStatement=parseVarStatement,exports.parseBlock=parseBlock,exports.parseBlockBody=parseBlockBody,exports.parseFunction=parseFunction,exports.parseFunctionParams=parseFunctionParams,exports.parseClass=parseClass,exports.parseClassPropertyName=parseClassPropertyName,exports.parsePostMemberNameModifiers=parsePostMemberNameModifiers,exports.parseClassProperty=parseClassProperty,exports.parseExport=parseExport,exports.parseExportFrom=parseExportFrom,exports.baseParseExportStar=baseParseExportStar,exports.parseExportSpecifiers=parseExportSpecifiers,exports.parseImport=parseImport;