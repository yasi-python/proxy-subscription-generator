"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var FunctionType,_index=require("../tokenizer/index"),_keywords=require("../tokenizer/keywords"),_types=require("../tokenizer/types"),_base=require("../traverser/base"),_expression=require("../traverser/expression"),_lval=require("../traverser/lval"),_statement=require("../traverser/statement"),_util=require("../traverser/util"),_jsx=require("./jsx");function tsIsIdentifier(){return _index.match.call(void 0,_types.TokenType.name)}function isLiteralPropertyName(){return _index.match.call(void 0,_types.TokenType.name)||Boolean(_base.state.type&_types.TokenType.IS_KEYWORD)||_index.match.call(void 0,_types.TokenType.string)||_index.match.call(void 0,_types.TokenType.num)||_index.match.call(void 0,_types.TokenType.bigint)||_index.match.call(void 0,_types.TokenType.decimal)}function tsNextTokenCanFollowModifier(){const e=_base.state.snapshot();return _index.next.call(void 0),!(!(_index.match.call(void 0,_types.TokenType.bracketL)||_index.match.call(void 0,_types.TokenType.braceL)||_index.match.call(void 0,_types.TokenType.star)||_index.match.call(void 0,_types.TokenType.ellipsis)||_index.match.call(void 0,_types.TokenType.hash)||isLiteralPropertyName())||_util.hasPrecedingLineBreak.call(void 0))||(_base.state.restoreFromSnapshot(e),!1)}function tsParseModifiers(e){for(;null!==tsParseModifier(e););}function tsParseModifier(e){if(!_index.match.call(void 0,_types.TokenType.name))return null;const t=_base.state.contextualKeyword;if(-1!==e.indexOf(t)&&tsNextTokenCanFollowModifier()){switch(t){case _keywords.ContextualKeyword._readonly:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._readonly;break;case _keywords.ContextualKeyword._abstract:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._abstract;break;case _keywords.ContextualKeyword._static:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._static;break;case _keywords.ContextualKeyword._public:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._public;break;case _keywords.ContextualKeyword._private:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._private;break;case _keywords.ContextualKeyword._protected:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._protected;break;case _keywords.ContextualKeyword._override:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._override;break;case _keywords.ContextualKeyword._declare:_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._declare}return t}return null}function tsParseEntityName(){for(_expression.parseIdentifier.call(void 0);_index.eat.call(void 0,_types.TokenType.dot);)_expression.parseIdentifier.call(void 0)}function tsParseTypeReference(){tsParseEntityName(),!_util.hasPrecedingLineBreak.call(void 0)&&_index.match.call(void 0,_types.TokenType.lessThan)&&tsParseTypeArguments()}function tsParseThisTypePredicate(){_index.next.call(void 0),tsParseTypeAnnotation()}function tsParseThisTypeNode(){_index.next.call(void 0)}function tsParseTypeQuery(){_util.expect.call(void 0,_types.TokenType._typeof),_index.match.call(void 0,_types.TokenType._import)?tsParseImportType():tsParseEntityName(),!_util.hasPrecedingLineBreak.call(void 0)&&_index.match.call(void 0,_types.TokenType.lessThan)&&tsParseTypeArguments()}function tsParseImportType(){_util.expect.call(void 0,_types.TokenType._import),_util.expect.call(void 0,_types.TokenType.parenL),_util.expect.call(void 0,_types.TokenType.string),_util.expect.call(void 0,_types.TokenType.parenR),_index.eat.call(void 0,_types.TokenType.dot)&&tsParseEntityName(),_index.match.call(void 0,_types.TokenType.lessThan)&&tsParseTypeArguments()}function tsParseTypeParameter(){_index.eat.call(void 0,_types.TokenType._const);const e=_index.eat.call(void 0,_types.TokenType._in),t=_util.eatContextual.call(void 0,_keywords.ContextualKeyword._out);_index.eat.call(void 0,_types.TokenType._const),!e&&!t||_index.match.call(void 0,_types.TokenType.name)?_expression.parseIdentifier.call(void 0):_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType.name,_index.eat.call(void 0,_types.TokenType._extends)&&tsParseType(),_index.eat.call(void 0,_types.TokenType.eq)&&tsParseType()}function tsTryParseTypeParameters(){_index.match.call(void 0,_types.TokenType.lessThan)&&tsParseTypeParameters()}function tsParseTypeParameters(){const e=_index.pushTypeContext.call(void 0,0);for(_index.match.call(void 0,_types.TokenType.lessThan)||_index.match.call(void 0,_types.TokenType.typeParameterStart)?_index.next.call(void 0):_util.unexpected.call(void 0);!_index.eat.call(void 0,_types.TokenType.greaterThan)&&!_base.state.error;)tsParseTypeParameter(),_index.eat.call(void 0,_types.TokenType.comma);_index.popTypeContext.call(void 0,e)}function tsFillSignature(e){const t=e===_types.TokenType.arrow;tsTryParseTypeParameters(),_util.expect.call(void 0,_types.TokenType.parenL),_base.state.scopeDepth++,tsParseBindingListForSignature(!1),_base.state.scopeDepth--,(t||_index.match.call(void 0,e))&&tsParseTypeOrTypePredicateAnnotation(e)}function tsParseBindingListForSignature(e){_lval.parseBindingList.call(void 0,_types.TokenType.parenR,e)}function tsParseTypeMemberSemicolon(){_index.eat.call(void 0,_types.TokenType.comma)||_util.semicolon.call(void 0)}function tsParseSignatureMember(){tsFillSignature(_types.TokenType.colon),tsParseTypeMemberSemicolon()}function tsIsUnambiguouslyIndexSignature(){const e=_base.state.snapshot();_index.next.call(void 0);const t=_index.eat.call(void 0,_types.TokenType.name)&&_index.match.call(void 0,_types.TokenType.colon);return _base.state.restoreFromSnapshot(e),t}function tsTryParseIndexSignature(){if(!_index.match.call(void 0,_types.TokenType.bracketL)||!tsIsUnambiguouslyIndexSignature())return!1;const e=_index.pushTypeContext.call(void 0,0);return _util.expect.call(void 0,_types.TokenType.bracketL),_expression.parseIdentifier.call(void 0),tsParseTypeAnnotation(),_util.expect.call(void 0,_types.TokenType.bracketR),tsTryParseTypeAnnotation(),tsParseTypeMemberSemicolon(),_index.popTypeContext.call(void 0,e),!0}function tsParsePropertyOrMethodSignature(e){_index.eat.call(void 0,_types.TokenType.question),e||!_index.match.call(void 0,_types.TokenType.parenL)&&!_index.match.call(void 0,_types.TokenType.lessThan)?(tsTryParseTypeAnnotation(),tsParseTypeMemberSemicolon()):(tsFillSignature(_types.TokenType.colon),tsParseTypeMemberSemicolon())}function tsParseTypeMember(){if(_index.match.call(void 0,_types.TokenType.parenL)||_index.match.call(void 0,_types.TokenType.lessThan))return void tsParseSignatureMember();if(_index.match.call(void 0,_types.TokenType._new))return _index.next.call(void 0),void(_index.match.call(void 0,_types.TokenType.parenL)||_index.match.call(void 0,_types.TokenType.lessThan)?tsParseSignatureMember():tsParsePropertyOrMethodSignature(!1));const e=!!tsParseModifier([_keywords.ContextualKeyword._readonly]);tsTryParseIndexSignature()||((_util.isContextual.call(void 0,_keywords.ContextualKeyword._get)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._set))&&tsNextTokenCanFollowModifier(),_expression.parsePropertyName.call(void 0,-1),tsParsePropertyOrMethodSignature(e))}function tsParseTypeLiteral(){tsParseObjectTypeMembers()}function tsParseObjectTypeMembers(){for(_util.expect.call(void 0,_types.TokenType.braceL);!_index.eat.call(void 0,_types.TokenType.braceR)&&!_base.state.error;)tsParseTypeMember()}function tsLookaheadIsStartOfMappedType(){const e=_base.state.snapshot(),t=tsIsStartOfMappedType();return _base.state.restoreFromSnapshot(e),t}function tsIsStartOfMappedType(){return _index.next.call(void 0),_index.eat.call(void 0,_types.TokenType.plus)||_index.eat.call(void 0,_types.TokenType.minus)?_util.isContextual.call(void 0,_keywords.ContextualKeyword._readonly):(_util.isContextual.call(void 0,_keywords.ContextualKeyword._readonly)&&_index.next.call(void 0),!!_index.match.call(void 0,_types.TokenType.bracketL)&&(_index.next.call(void 0),!!tsIsIdentifier()&&(_index.next.call(void 0),_index.match.call(void 0,_types.TokenType._in))))}function tsParseMappedTypeParameter(){_expression.parseIdentifier.call(void 0),_util.expect.call(void 0,_types.TokenType._in),tsParseType()}function tsParseMappedType(){_util.expect.call(void 0,_types.TokenType.braceL),_index.match.call(void 0,_types.TokenType.plus)||_index.match.call(void 0,_types.TokenType.minus)?(_index.next.call(void 0),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._readonly)):_util.eatContextual.call(void 0,_keywords.ContextualKeyword._readonly),_util.expect.call(void 0,_types.TokenType.bracketL),tsParseMappedTypeParameter(),_util.eatContextual.call(void 0,_keywords.ContextualKeyword._as)&&tsParseType(),_util.expect.call(void 0,_types.TokenType.bracketR),_index.match.call(void 0,_types.TokenType.plus)||_index.match.call(void 0,_types.TokenType.minus)?(_index.next.call(void 0),_util.expect.call(void 0,_types.TokenType.question)):_index.eat.call(void 0,_types.TokenType.question),tsTryParseType(),_util.semicolon.call(void 0),_util.expect.call(void 0,_types.TokenType.braceR)}function tsParseTupleType(){for(_util.expect.call(void 0,_types.TokenType.bracketL);!_index.eat.call(void 0,_types.TokenType.bracketR)&&!_base.state.error;)tsParseTupleElementType(),_index.eat.call(void 0,_types.TokenType.comma)}function tsParseTupleElementType(){_index.eat.call(void 0,_types.TokenType.ellipsis)?tsParseType():(tsParseType(),_index.eat.call(void 0,_types.TokenType.question)),_index.eat.call(void 0,_types.TokenType.colon)&&tsParseType()}function tsParseParenthesizedType(){_util.expect.call(void 0,_types.TokenType.parenL),tsParseType(),_util.expect.call(void 0,_types.TokenType.parenR)}function tsParseTemplateLiteralType(){for(_index.nextTemplateToken.call(void 0),_index.nextTemplateToken.call(void 0);!_index.match.call(void 0,_types.TokenType.backQuote)&&!_base.state.error;)_util.expect.call(void 0,_types.TokenType.dollarBraceL),tsParseType(),_index.nextTemplateToken.call(void 0),_index.nextTemplateToken.call(void 0);_index.next.call(void 0)}function tsParseFunctionOrConstructorType(e){e===FunctionType.TSAbstractConstructorType&&_util.expectContextual.call(void 0,_keywords.ContextualKeyword._abstract),e!==FunctionType.TSConstructorType&&e!==FunctionType.TSAbstractConstructorType||_util.expect.call(void 0,_types.TokenType._new);const t=_base.state.inDisallowConditionalTypesContext;_base.state.inDisallowConditionalTypesContext=!1,tsFillSignature(_types.TokenType.arrow),_base.state.inDisallowConditionalTypesContext=t}function tsParseNonArrayType(){switch(_base.state.type){case _types.TokenType.name:return void tsParseTypeReference();case _types.TokenType._void:case _types.TokenType._null:return void _index.next.call(void 0);case _types.TokenType.string:case _types.TokenType.num:case _types.TokenType.bigint:case _types.TokenType.decimal:case _types.TokenType._true:case _types.TokenType._false:return void _expression.parseLiteral.call(void 0);case _types.TokenType.minus:return _index.next.call(void 0),void _expression.parseLiteral.call(void 0);case _types.TokenType._this:return tsParseThisTypeNode(),void(_util.isContextual.call(void 0,_keywords.ContextualKeyword._is)&&!_util.hasPrecedingLineBreak.call(void 0)&&tsParseThisTypePredicate());case _types.TokenType._typeof:return void tsParseTypeQuery();case _types.TokenType._import:return void tsParseImportType();case _types.TokenType.braceL:return void(tsLookaheadIsStartOfMappedType()?tsParseMappedType():tsParseTypeLiteral());case _types.TokenType.bracketL:return void tsParseTupleType();case _types.TokenType.parenL:return void tsParseParenthesizedType();case _types.TokenType.backQuote:return void tsParseTemplateLiteralType();default:if(_base.state.type&_types.TokenType.IS_KEYWORD)return _index.next.call(void 0),void(_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType.name)}_util.unexpected.call(void 0)}function tsParseArrayTypeOrHigher(){for(tsParseNonArrayType();!_util.hasPrecedingLineBreak.call(void 0)&&_index.eat.call(void 0,_types.TokenType.bracketL);)_index.eat.call(void 0,_types.TokenType.bracketR)||(tsParseType(),_util.expect.call(void 0,_types.TokenType.bracketR))}function tsParseInferType(){if(_util.expectContextual.call(void 0,_keywords.ContextualKeyword._infer),_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType._extends)){const e=_base.state.snapshot();_util.expect.call(void 0,_types.TokenType._extends);const t=_base.state.inDisallowConditionalTypesContext;_base.state.inDisallowConditionalTypesContext=!0,tsParseType(),_base.state.inDisallowConditionalTypesContext=t,(_base.state.error||!_base.state.inDisallowConditionalTypesContext&&_index.match.call(void 0,_types.TokenType.question))&&_base.state.restoreFromSnapshot(e)}}function tsParseTypeOperatorOrHigher(){if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._keyof)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._unique)||_util.isContextual.call(void 0,_keywords.ContextualKeyword._readonly))_index.next.call(void 0),tsParseTypeOperatorOrHigher();else if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._infer))tsParseInferType();else{const e=_base.state.inDisallowConditionalTypesContext;_base.state.inDisallowConditionalTypesContext=!1,tsParseArrayTypeOrHigher(),_base.state.inDisallowConditionalTypesContext=e}}function tsParseIntersectionTypeOrHigher(){if(_index.eat.call(void 0,_types.TokenType.bitwiseAND),tsParseTypeOperatorOrHigher(),_index.match.call(void 0,_types.TokenType.bitwiseAND))for(;_index.eat.call(void 0,_types.TokenType.bitwiseAND);)tsParseTypeOperatorOrHigher()}function tsParseUnionTypeOrHigher(){if(_index.eat.call(void 0,_types.TokenType.bitwiseOR),tsParseIntersectionTypeOrHigher(),_index.match.call(void 0,_types.TokenType.bitwiseOR))for(;_index.eat.call(void 0,_types.TokenType.bitwiseOR);)tsParseIntersectionTypeOrHigher()}function tsIsStartOfFunctionType(){return!!_index.match.call(void 0,_types.TokenType.lessThan)||_index.match.call(void 0,_types.TokenType.parenL)&&tsLookaheadIsUnambiguouslyStartOfFunctionType()}function tsSkipParameterStart(){if(_index.match.call(void 0,_types.TokenType.name)||_index.match.call(void 0,_types.TokenType._this))return _index.next.call(void 0),!0;if(_index.match.call(void 0,_types.TokenType.braceL)||_index.match.call(void 0,_types.TokenType.bracketL)){let e=1;for(_index.next.call(void 0);e>0&&!_base.state.error;)_index.match.call(void 0,_types.TokenType.braceL)||_index.match.call(void 0,_types.TokenType.bracketL)?e++:(_index.match.call(void 0,_types.TokenType.braceR)||_index.match.call(void 0,_types.TokenType.bracketR))&&e--,_index.next.call(void 0);return!0}return!1}function tsLookaheadIsUnambiguouslyStartOfFunctionType(){const e=_base.state.snapshot(),t=tsIsUnambiguouslyStartOfFunctionType();return _base.state.restoreFromSnapshot(e),t}function tsIsUnambiguouslyStartOfFunctionType(){if(_index.next.call(void 0),_index.match.call(void 0,_types.TokenType.parenR)||_index.match.call(void 0,_types.TokenType.ellipsis))return!0;if(tsSkipParameterStart()){if(_index.match.call(void 0,_types.TokenType.colon)||_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.question)||_index.match.call(void 0,_types.TokenType.eq))return!0;if(_index.match.call(void 0,_types.TokenType.parenR)&&(_index.next.call(void 0),_index.match.call(void 0,_types.TokenType.arrow)))return!0}return!1}function tsParseTypeOrTypePredicateAnnotation(e){const t=_index.pushTypeContext.call(void 0,0);_util.expect.call(void 0,e),tsParseTypePredicateOrAssertsPrefix()||tsParseType(),_index.popTypeContext.call(void 0,t)}function tsTryParseTypeOrTypePredicateAnnotation(){_index.match.call(void 0,_types.TokenType.colon)&&tsParseTypeOrTypePredicateAnnotation(_types.TokenType.colon)}function tsTryParseTypeAnnotation(){_index.match.call(void 0,_types.TokenType.colon)&&tsParseTypeAnnotation()}function tsTryParseType(){_index.eat.call(void 0,_types.TokenType.colon)&&tsParseType()}function tsParseTypePredicateOrAssertsPrefix(){const e=_base.state.snapshot();return _util.isContextual.call(void 0,_keywords.ContextualKeyword._asserts)?(_index.next.call(void 0),_util.eatContextual.call(void 0,_keywords.ContextualKeyword._is)?(tsParseType(),!0):tsIsIdentifier()||_index.match.call(void 0,_types.TokenType._this)?(_index.next.call(void 0),_util.eatContextual.call(void 0,_keywords.ContextualKeyword._is)&&tsParseType(),!0):(_base.state.restoreFromSnapshot(e),!1)):!(!tsIsIdentifier()&&!_index.match.call(void 0,_types.TokenType._this)||(_index.next.call(void 0),_util.isContextual.call(void 0,_keywords.ContextualKeyword._is)&&!_util.hasPrecedingLineBreak.call(void 0)?(_index.next.call(void 0),tsParseType(),0):(_base.state.restoreFromSnapshot(e),1)))}function tsParseTypeAnnotation(){const e=_index.pushTypeContext.call(void 0,0);_util.expect.call(void 0,_types.TokenType.colon),tsParseType(),_index.popTypeContext.call(void 0,e)}function tsParseType(){if(tsParseNonConditionalType(),_base.state.inDisallowConditionalTypesContext||_util.hasPrecedingLineBreak.call(void 0)||!_index.eat.call(void 0,_types.TokenType._extends))return;const e=_base.state.inDisallowConditionalTypesContext;_base.state.inDisallowConditionalTypesContext=!0,tsParseNonConditionalType(),_base.state.inDisallowConditionalTypesContext=e,_util.expect.call(void 0,_types.TokenType.question),tsParseType(),_util.expect.call(void 0,_types.TokenType.colon),tsParseType()}function isAbstractConstructorSignature(){return _util.isContextual.call(void 0,_keywords.ContextualKeyword._abstract)&&_index.lookaheadType.call(void 0)===_types.TokenType._new}function tsParseNonConditionalType(){tsIsStartOfFunctionType()?tsParseFunctionOrConstructorType(FunctionType.TSFunctionType):_index.match.call(void 0,_types.TokenType._new)?tsParseFunctionOrConstructorType(FunctionType.TSConstructorType):isAbstractConstructorSignature()?tsParseFunctionOrConstructorType(FunctionType.TSAbstractConstructorType):tsParseUnionTypeOrHigher()}function tsParseTypeAssertion(){const e=_index.pushTypeContext.call(void 0,1);tsParseType(),_util.expect.call(void 0,_types.TokenType.greaterThan),_index.popTypeContext.call(void 0,e),_expression.parseMaybeUnary.call(void 0)}function tsTryParseJSXTypeArgument(){if(_index.eat.call(void 0,_types.TokenType.jsxTagStart)){_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType.typeParameterStart;const e=_index.pushTypeContext.call(void 0,1);for(;!_index.match.call(void 0,_types.TokenType.greaterThan)&&!_base.state.error;)tsParseType(),_index.eat.call(void 0,_types.TokenType.comma);_jsx.nextJSXTagToken.call(void 0),_index.popTypeContext.call(void 0,e)}}function tsParseHeritageClause(){for(;!_index.match.call(void 0,_types.TokenType.braceL)&&!_base.state.error;)tsParseExpressionWithTypeArguments(),_index.eat.call(void 0,_types.TokenType.comma)}function tsParseExpressionWithTypeArguments(){tsParseEntityName(),_index.match.call(void 0,_types.TokenType.lessThan)&&tsParseTypeArguments()}function tsParseInterfaceDeclaration(){_lval.parseBindingIdentifier.call(void 0,!1),tsTryParseTypeParameters(),_index.eat.call(void 0,_types.TokenType._extends)&&tsParseHeritageClause(),tsParseObjectTypeMembers()}function tsParseTypeAliasDeclaration(){_lval.parseBindingIdentifier.call(void 0,!1),tsTryParseTypeParameters(),_util.expect.call(void 0,_types.TokenType.eq),tsParseType(),_util.semicolon.call(void 0)}function tsParseEnumMember(){if(_index.match.call(void 0,_types.TokenType.string)?_expression.parseLiteral.call(void 0):_expression.parseIdentifier.call(void 0),_index.eat.call(void 0,_types.TokenType.eq)){const e=_base.state.tokens.length-1;_expression.parseMaybeAssign.call(void 0),_base.state.tokens[e].rhsEndIndex=_base.state.tokens.length}}function tsParseEnumDeclaration(){for(_lval.parseBindingIdentifier.call(void 0,!1),_util.expect.call(void 0,_types.TokenType.braceL);!_index.eat.call(void 0,_types.TokenType.braceR)&&!_base.state.error;)tsParseEnumMember(),_index.eat.call(void 0,_types.TokenType.comma)}function tsParseModuleBlock(){_util.expect.call(void 0,_types.TokenType.braceL),_statement.parseBlockBody.call(void 0,_types.TokenType.braceR)}function tsParseModuleOrNamespaceDeclaration(){_lval.parseBindingIdentifier.call(void 0,!1),_index.eat.call(void 0,_types.TokenType.dot)?tsParseModuleOrNamespaceDeclaration():tsParseModuleBlock()}function tsParseAmbientExternalModuleDeclaration(){_util.isContextual.call(void 0,_keywords.ContextualKeyword._global)?_expression.parseIdentifier.call(void 0):_index.match.call(void 0,_types.TokenType.string)?_expression.parseExprAtom.call(void 0):_util.unexpected.call(void 0),_index.match.call(void 0,_types.TokenType.braceL)?tsParseModuleBlock():_util.semicolon.call(void 0)}function tsParseImportEqualsDeclaration(){_lval.parseImportedIdentifier.call(void 0),_util.expect.call(void 0,_types.TokenType.eq),tsParseModuleReference(),_util.semicolon.call(void 0)}function tsIsExternalModuleReference(){return _util.isContextual.call(void 0,_keywords.ContextualKeyword._require)&&_index.lookaheadType.call(void 0)===_types.TokenType.parenL}function tsParseModuleReference(){tsIsExternalModuleReference()?tsParseExternalModuleReference():tsParseEntityName()}function tsParseExternalModuleReference(){_util.expectContextual.call(void 0,_keywords.ContextualKeyword._require),_util.expect.call(void 0,_types.TokenType.parenL),_index.match.call(void 0,_types.TokenType.string)||_util.unexpected.call(void 0),_expression.parseLiteral.call(void 0),_util.expect.call(void 0,_types.TokenType.parenR)}function tsTryParseDeclare(){if(_util.isLineTerminator.call(void 0))return!1;switch(_base.state.type){case _types.TokenType._function:{const e=_index.pushTypeContext.call(void 0,1);_index.next.call(void 0);const t=_base.state.start;return _statement.parseFunction.call(void 0,t,!0),_index.popTypeContext.call(void 0,e),!0}case _types.TokenType._class:{const e=_index.pushTypeContext.call(void 0,1);return _statement.parseClass.call(void 0,!0,!1),_index.popTypeContext.call(void 0,e),!0}case _types.TokenType._const:if(_index.match.call(void 0,_types.TokenType._const)&&_util.isLookaheadContextual.call(void 0,_keywords.ContextualKeyword._enum)){const e=_index.pushTypeContext.call(void 0,1);return _util.expect.call(void 0,_types.TokenType._const),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._enum),_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._enum,tsParseEnumDeclaration(),_index.popTypeContext.call(void 0,e),!0}case _types.TokenType._var:case _types.TokenType._let:{const e=_index.pushTypeContext.call(void 0,1);return _statement.parseVarStatement.call(void 0,_base.state.type!==_types.TokenType._var),_index.popTypeContext.call(void 0,e),!0}case _types.TokenType.name:{const e=_index.pushTypeContext.call(void 0,1),t=_base.state.contextualKeyword;let s=!1;return t===_keywords.ContextualKeyword._global?(tsParseAmbientExternalModuleDeclaration(),s=!0):s=tsParseDeclaration(t,!0),_index.popTypeContext.call(void 0,e),s}default:return!1}}function tsTryParseExportDeclaration(){return tsParseDeclaration(_base.state.contextualKeyword,!0)}function tsParseExpressionStatement(e){switch(e){case _keywords.ContextualKeyword._declare:{const e=_base.state.tokens.length-1;if(tsTryParseDeclare())return _base.state.tokens[e].type=_types.TokenType._declare,!0;break}case _keywords.ContextualKeyword._global:if(_index.match.call(void 0,_types.TokenType.braceL))return tsParseModuleBlock(),!0;break;default:return tsParseDeclaration(e,!1)}return!1}function tsParseDeclaration(e,t){switch(e){case _keywords.ContextualKeyword._abstract:if(tsCheckLineTerminator(t)&&_index.match.call(void 0,_types.TokenType._class))return _base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._abstract,_statement.parseClass.call(void 0,!0,!1),!0;break;case _keywords.ContextualKeyword._enum:if(tsCheckLineTerminator(t)&&_index.match.call(void 0,_types.TokenType.name))return _base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._enum,tsParseEnumDeclaration(),!0;break;case _keywords.ContextualKeyword._interface:if(tsCheckLineTerminator(t)&&_index.match.call(void 0,_types.TokenType.name)){const e=_index.pushTypeContext.call(void 0,t?2:1);return tsParseInterfaceDeclaration(),_index.popTypeContext.call(void 0,e),!0}break;case _keywords.ContextualKeyword._module:if(tsCheckLineTerminator(t)){if(_index.match.call(void 0,_types.TokenType.string)){const e=_index.pushTypeContext.call(void 0,t?2:1);return tsParseAmbientExternalModuleDeclaration(),_index.popTypeContext.call(void 0,e),!0}if(_index.match.call(void 0,_types.TokenType.name)){const e=_index.pushTypeContext.call(void 0,t?2:1);return tsParseModuleOrNamespaceDeclaration(),_index.popTypeContext.call(void 0,e),!0}}break;case _keywords.ContextualKeyword._namespace:if(tsCheckLineTerminator(t)&&_index.match.call(void 0,_types.TokenType.name)){const e=_index.pushTypeContext.call(void 0,t?2:1);return tsParseModuleOrNamespaceDeclaration(),_index.popTypeContext.call(void 0,e),!0}break;case _keywords.ContextualKeyword._type:if(tsCheckLineTerminator(t)&&_index.match.call(void 0,_types.TokenType.name)){const e=_index.pushTypeContext.call(void 0,t?2:1);return tsParseTypeAliasDeclaration(),_index.popTypeContext.call(void 0,e),!0}}return!1}function tsCheckLineTerminator(e){return e?(_index.next.call(void 0),!0):!_util.isLineTerminator.call(void 0)}function tsTryParseGenericAsyncArrowFunction(){const e=_base.state.snapshot();return tsParseTypeParameters(),_statement.parseFunctionParams.call(void 0),tsTryParseTypeOrTypePredicateAnnotation(),_util.expect.call(void 0,_types.TokenType.arrow),_base.state.error?(_base.state.restoreFromSnapshot(e),!1):(_expression.parseFunctionBody.call(void 0,!0),!0)}function tsParseTypeArgumentsWithPossibleBitshift(){_base.state.type===_types.TokenType.bitShiftL&&(_base.state.pos-=1,_index.finishToken.call(void 0,_types.TokenType.lessThan)),tsParseTypeArguments()}function tsParseTypeArguments(){const e=_index.pushTypeContext.call(void 0,0);for(_util.expect.call(void 0,_types.TokenType.lessThan);!_index.match.call(void 0,_types.TokenType.greaterThan)&&!_base.state.error;)tsParseType(),_index.eat.call(void 0,_types.TokenType.comma);e?(_util.expect.call(void 0,_types.TokenType.greaterThan),_index.popTypeContext.call(void 0,e)):(_index.popTypeContext.call(void 0,e),_index.rescan_gt.call(void 0),_util.expect.call(void 0,_types.TokenType.greaterThan),_base.state.tokens[_base.state.tokens.length-1].isType=!0)}function tsIsDeclarationStart(){if(_index.match.call(void 0,_types.TokenType.name))switch(_base.state.contextualKeyword){case _keywords.ContextualKeyword._abstract:case _keywords.ContextualKeyword._declare:case _keywords.ContextualKeyword._enum:case _keywords.ContextualKeyword._interface:case _keywords.ContextualKeyword._module:case _keywords.ContextualKeyword._namespace:case _keywords.ContextualKeyword._type:return!0}return!1}function tsParseFunctionBodyAndFinish(e,t){if(_index.match.call(void 0,_types.TokenType.colon)&&tsParseTypeOrTypePredicateAnnotation(_types.TokenType.colon),!_index.match.call(void 0,_types.TokenType.braceL)&&_util.isLineTerminator.call(void 0)){let t=_base.state.tokens.length-1;for(;t>=0&&(_base.state.tokens[t].start>=e||_base.state.tokens[t].type===_types.TokenType._default||_base.state.tokens[t].type===_types.TokenType._export);)_base.state.tokens[t].isType=!0,t--;return}_expression.parseFunctionBody.call(void 0,!1,t)}function tsParseSubscript(e,t,s){if(_util.hasPrecedingLineBreak.call(void 0)||!_index.eat.call(void 0,_types.TokenType.bang)){if(_index.match.call(void 0,_types.TokenType.lessThan)||_index.match.call(void 0,_types.TokenType.bitShiftL)){const s=_base.state.snapshot();if(!t&&_expression.atPossibleAsync.call(void 0)&&tsTryParseGenericAsyncArrowFunction())return;if(tsParseTypeArgumentsWithPossibleBitshift(),!t&&_index.eat.call(void 0,_types.TokenType.parenL)?(_base.state.tokens[_base.state.tokens.length-1].subscriptStartIndex=e,_expression.parseCallExpressionArguments.call(void 0)):_index.match.call(void 0,_types.TokenType.backQuote)?_expression.parseTemplate.call(void 0):(_base.state.type===_types.TokenType.greaterThan||_base.state.type!==_types.TokenType.parenL&&Boolean(_base.state.type&_types.TokenType.IS_EXPRESSION_START)&&!_util.hasPrecedingLineBreak.call(void 0))&&_util.unexpected.call(void 0),!_base.state.error)return;_base.state.restoreFromSnapshot(s)}else!t&&_index.match.call(void 0,_types.TokenType.questionDot)&&_index.lookaheadType.call(void 0)===_types.TokenType.lessThan&&(_index.next.call(void 0),_base.state.tokens[e].isOptionalChainStart=!0,_base.state.tokens[_base.state.tokens.length-1].subscriptStartIndex=e,tsParseTypeArguments(),_util.expect.call(void 0,_types.TokenType.parenL),_expression.parseCallExpressionArguments.call(void 0));_expression.baseParseSubscript.call(void 0,e,t,s)}else _base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType.nonNullAssertion}function tsTryParseExport(){if(_index.eat.call(void 0,_types.TokenType._import))return _util.isContextual.call(void 0,_keywords.ContextualKeyword._type)&&_index.lookaheadType.call(void 0)!==_types.TokenType.eq&&_util.expectContextual.call(void 0,_keywords.ContextualKeyword._type),tsParseImportEqualsDeclaration(),!0;if(_index.eat.call(void 0,_types.TokenType.eq))return _expression.parseExpression.call(void 0),_util.semicolon.call(void 0),!0;if(_util.eatContextual.call(void 0,_keywords.ContextualKeyword._as))return _util.expectContextual.call(void 0,_keywords.ContextualKeyword._namespace),_expression.parseIdentifier.call(void 0),_util.semicolon.call(void 0),!0;if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._type)){const e=_index.lookaheadType.call(void 0);e!==_types.TokenType.braceL&&e!==_types.TokenType.star||_index.next.call(void 0)}return!1}function tsParseImportSpecifier(){if(_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR))_base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ImportDeclaration;else{if(_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR))return _base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ImportDeclaration,_base.state.tokens[_base.state.tokens.length-2].isType=!0,void(_base.state.tokens[_base.state.tokens.length-1].isType=!0);if(_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR))return _base.state.tokens[_base.state.tokens.length-3].identifierRole=_index.IdentifierRole.ImportAccess,void(_base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ImportDeclaration);_expression.parseIdentifier.call(void 0),_base.state.tokens[_base.state.tokens.length-3].identifierRole=_index.IdentifierRole.ImportAccess,_base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ImportDeclaration,_base.state.tokens[_base.state.tokens.length-4].isType=!0,_base.state.tokens[_base.state.tokens.length-3].isType=!0,_base.state.tokens[_base.state.tokens.length-2].isType=!0,_base.state.tokens[_base.state.tokens.length-1].isType=!0}}function tsParseExportSpecifier(){if(_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR))_base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ExportAccess;else{if(_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR))return _base.state.tokens[_base.state.tokens.length-1].identifierRole=_index.IdentifierRole.ExportAccess,_base.state.tokens[_base.state.tokens.length-2].isType=!0,void(_base.state.tokens[_base.state.tokens.length-1].isType=!0);_expression.parseIdentifier.call(void 0),_index.match.call(void 0,_types.TokenType.comma)||_index.match.call(void 0,_types.TokenType.braceR)?_base.state.tokens[_base.state.tokens.length-3].identifierRole=_index.IdentifierRole.ExportAccess:(_expression.parseIdentifier.call(void 0),_base.state.tokens[_base.state.tokens.length-3].identifierRole=_index.IdentifierRole.ExportAccess,_base.state.tokens[_base.state.tokens.length-4].isType=!0,_base.state.tokens[_base.state.tokens.length-3].isType=!0,_base.state.tokens[_base.state.tokens.length-2].isType=!0,_base.state.tokens[_base.state.tokens.length-1].isType=!0)}}function tsTryParseExportDefaultExpression(){if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._abstract)&&_index.lookaheadType.call(void 0)===_types.TokenType._class)return _base.state.type=_types.TokenType._abstract,_index.next.call(void 0),_statement.parseClass.call(void 0,!0,!0),!0;if(_util.isContextual.call(void 0,_keywords.ContextualKeyword._interface)){const e=_index.pushTypeContext.call(void 0,2);return tsParseDeclaration(_keywords.ContextualKeyword._interface,!0),_index.popTypeContext.call(void 0,e),!0}return!1}function tsTryParseStatementContent(){if(_base.state.type===_types.TokenType._const){const e=_index.lookaheadTypeAndKeyword.call(void 0);if(e.type===_types.TokenType.name&&e.contextualKeyword===_keywords.ContextualKeyword._enum)return _util.expect.call(void 0,_types.TokenType._const),_util.expectContextual.call(void 0,_keywords.ContextualKeyword._enum),_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._enum,tsParseEnumDeclaration(),!0}return!1}function tsTryParseClassMemberWithIsStatic(e){const t=_base.state.tokens.length;tsParseModifiers([_keywords.ContextualKeyword._abstract,_keywords.ContextualKeyword._readonly,_keywords.ContextualKeyword._declare,_keywords.ContextualKeyword._static,_keywords.ContextualKeyword._override]);const s=_base.state.tokens.length;if(tsTryParseIndexSignature()){for(let a=e?t-1:t;a<s;a++)_base.state.tokens[a].isType=!0;return!0}return!1}function tsParseIdentifierStatement(e){tsParseExpressionStatement(e)||_util.semicolon.call(void 0)}function tsParseExportDeclaration(){const e=_util.eatContextual.call(void 0,_keywords.ContextualKeyword._declare);e&&(_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._declare);let t=!1;if(_index.match.call(void 0,_types.TokenType.name))if(e){const e=_index.pushTypeContext.call(void 0,2);t=tsTryParseExportDeclaration(),_index.popTypeContext.call(void 0,e)}else t=tsTryParseExportDeclaration();if(!t)if(e){const e=_index.pushTypeContext.call(void 0,2);_statement.parseStatement.call(void 0,!0),_index.popTypeContext.call(void 0,e)}else _statement.parseStatement.call(void 0,!0)}function tsAfterParseClassSuper(e){if(e&&(_index.match.call(void 0,_types.TokenType.lessThan)||_index.match.call(void 0,_types.TokenType.bitShiftL))&&tsParseTypeArgumentsWithPossibleBitshift(),_util.eatContextual.call(void 0,_keywords.ContextualKeyword._implements)){_base.state.tokens[_base.state.tokens.length-1].type=_types.TokenType._implements;const e=_index.pushTypeContext.call(void 0,1);tsParseHeritageClause(),_index.popTypeContext.call(void 0,e)}}function tsStartParseObjPropValue(){tsTryParseTypeParameters()}function tsStartParseFunctionParams(){tsTryParseTypeParameters()}function tsAfterParseVarHead(){const e=_index.pushTypeContext.call(void 0,0);_util.hasPrecedingLineBreak.call(void 0)||_index.eat.call(void 0,_types.TokenType.bang),tsTryParseTypeAnnotation(),_index.popTypeContext.call(void 0,e)}function tsStartParseAsyncArrowFromCallExpression(){_index.match.call(void 0,_types.TokenType.colon)&&tsParseTypeAnnotation()}function tsParseMaybeAssign(e,t){return _base.isJSXEnabled?tsParseMaybeAssignWithJSX(e,t):tsParseMaybeAssignWithoutJSX(e,t)}function tsParseMaybeAssignWithJSX(e,t){if(!_index.match.call(void 0,_types.TokenType.lessThan))return _expression.baseParseMaybeAssign.call(void 0,e,t);const s=_base.state.snapshot();let a=_expression.baseParseMaybeAssign.call(void 0,e,t);return _base.state.error?(_base.state.restoreFromSnapshot(s),_base.state.type=_types.TokenType.typeParameterStart,tsParseTypeParameters(),a=_expression.baseParseMaybeAssign.call(void 0,e,t),a||_util.unexpected.call(void 0),a):a}function tsParseMaybeAssignWithoutJSX(e,t){if(!_index.match.call(void 0,_types.TokenType.lessThan))return _expression.baseParseMaybeAssign.call(void 0,e,t);const s=_base.state.snapshot();tsParseTypeParameters();const a=_expression.baseParseMaybeAssign.call(void 0,e,t);return a||_util.unexpected.call(void 0),_base.state.error?(_base.state.restoreFromSnapshot(s),_expression.baseParseMaybeAssign.call(void 0,e,t)):a}function tsParseArrow(){if(_index.match.call(void 0,_types.TokenType.colon)){const e=_base.state.snapshot();tsParseTypeOrTypePredicateAnnotation(_types.TokenType.colon),_util.canInsertSemicolon.call(void 0)&&_util.unexpected.call(void 0),_index.match.call(void 0,_types.TokenType.arrow)||_util.unexpected.call(void 0),_base.state.error&&_base.state.restoreFromSnapshot(e)}return _index.eat.call(void 0,_types.TokenType.arrow)}function tsParseAssignableListItemTypes(){const e=_index.pushTypeContext.call(void 0,0);_index.eat.call(void 0,_types.TokenType.question),tsTryParseTypeAnnotation(),_index.popTypeContext.call(void 0,e)}function tsParseMaybeDecoratorArguments(){(_index.match.call(void 0,_types.TokenType.lessThan)||_index.match.call(void 0,_types.TokenType.bitShiftL))&&tsParseTypeArgumentsWithPossibleBitshift(),_statement.baseParseMaybeDecoratorArguments.call(void 0)}exports.tsParseModifiers=tsParseModifiers,exports.tsParseModifier=tsParseModifier,exports.tsTryParseTypeParameters=tsTryParseTypeParameters,function(e){e[e.TSFunctionType=0]="TSFunctionType",e[e.TSConstructorType=1]="TSConstructorType",e[e.TSAbstractConstructorType=2]="TSAbstractConstructorType"}(FunctionType||(FunctionType={})),exports.tsTryParseTypeAnnotation=tsTryParseTypeAnnotation,exports.tsParseTypeAnnotation=tsParseTypeAnnotation,exports.tsParseType=tsParseType,exports.tsParseNonConditionalType=tsParseNonConditionalType,exports.tsParseTypeAssertion=tsParseTypeAssertion,exports.tsTryParseJSXTypeArgument=tsTryParseJSXTypeArgument,exports.tsParseImportEqualsDeclaration=tsParseImportEqualsDeclaration,exports.tsIsDeclarationStart=tsIsDeclarationStart,exports.tsParseFunctionBodyAndFinish=tsParseFunctionBodyAndFinish,exports.tsParseSubscript=tsParseSubscript,exports.tsTryParseExport=tsTryParseExport,exports.tsParseImportSpecifier=tsParseImportSpecifier,exports.tsParseExportSpecifier=tsParseExportSpecifier,exports.tsTryParseExportDefaultExpression=tsTryParseExportDefaultExpression,exports.tsTryParseStatementContent=tsTryParseStatementContent,exports.tsTryParseClassMemberWithIsStatic=tsTryParseClassMemberWithIsStatic,exports.tsParseIdentifierStatement=tsParseIdentifierStatement,exports.tsParseExportDeclaration=tsParseExportDeclaration,exports.tsAfterParseClassSuper=tsAfterParseClassSuper,exports.tsStartParseObjPropValue=tsStartParseObjPropValue,exports.tsStartParseFunctionParams=tsStartParseFunctionParams,exports.tsAfterParseVarHead=tsAfterParseVarHead,exports.tsStartParseAsyncArrowFromCallExpression=tsStartParseAsyncArrowFromCallExpression,exports.tsParseMaybeAssign=tsParseMaybeAssign,exports.tsParseMaybeAssignWithJSX=tsParseMaybeAssignWithJSX,exports.tsParseMaybeAssignWithoutJSX=tsParseMaybeAssignWithoutJSX,exports.tsParseArrow=tsParseArrow,exports.tsParseAssignableListItemTypes=tsParseAssignableListItemTypes,exports.tsParseMaybeDecoratorArguments=tsParseMaybeDecoratorArguments;