"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _CJSImportProcessor=require("./CJSImportProcessor"),_CJSImportProcessor2=_interopRequireDefault(_CJSImportProcessor),_computeSourceMap=require("./computeSourceMap"),_computeSourceMap2=_interopRequireDefault(_computeSourceMap),_HelperManager=require("./HelperManager"),_identifyShadowedGlobals=require("./identifyShadowedGlobals"),_identifyShadowedGlobals2=_interopRequireDefault(_identifyShadowedGlobals),_NameManager=require("./NameManager"),_NameManager2=_interopRequireDefault(_NameManager),_Options=require("./Options"),_parser=require("./parser"),_TokenProcessor=require("./TokenProcessor"),_TokenProcessor2=_interopRequireDefault(_TokenProcessor),_RootTransformer=require("./transformers/RootTransformer"),_RootTransformer2=_interopRequireDefault(_RootTransformer),_formatTokens=require("./util/formatTokens"),_formatTokens2=_interopRequireDefault(_formatTokens),_getTSImportedNames=require("./util/getTSImportedNames"),_getTSImportedNames2=_interopRequireDefault(_getTSImportedNames);function getVersion(){return"3.35.0"}function transform(e,r){_Options.validateOptions.call(void 0,r);try{const o=getSucraseContext(e,r),t=new(0,_RootTransformer2.default)(o,r.transforms,Boolean(r.enableLegacyBabel5ModuleInterop),r).transform();let s={code:t.code};if(r.sourceMapOptions){if(!r.filePath)throw new Error("filePath must be specified when generating a source map.");s={...s,sourceMap:_computeSourceMap2.default.call(void 0,t,r.filePath,r.sourceMapOptions,e,o.tokenProcessor.tokens)}}return s}catch(e){throw r.filePath&&(e.message=`Error transforming ${r.filePath}: ${e.message}`),e}}function getFormattedTokens(e,r){const o=getSucraseContext(e,r).tokenProcessor.tokens;return _formatTokens2.default.call(void 0,e,o)}function getSucraseContext(e,r){const o=r.transforms.includes("jsx"),t=r.transforms.includes("typescript"),s=r.transforms.includes("flow"),a=!0===r.disableESTransforms,n=_parser.parse.call(void 0,e,o,t,s),i=n.tokens,u=n.scopes,l=new(0,_NameManager2.default)(e,i),p=new(0,_HelperManager.HelperManager)(l),c=new(0,_TokenProcessor2.default)(e,i,s,a,p),f=Boolean(r.enableLegacyTypeScriptModuleInterop);let m=null;return r.transforms.includes("imports")?(m=new(0,_CJSImportProcessor2.default)(l,c,f,r,r.transforms.includes("typescript"),Boolean(r.keepUnusedImports),p),m.preprocessTokens(),_identifyShadowedGlobals2.default.call(void 0,c,u,m.getGlobalNames()),r.transforms.includes("typescript")&&!r.keepUnusedImports&&m.pruneTypeOnlyImports()):r.transforms.includes("typescript")&&!r.keepUnusedImports&&_identifyShadowedGlobals2.default.call(void 0,c,u,_getTSImportedNames2.default.call(void 0,c)),{tokenProcessor:c,scopes:u,nameManager:l,importProcessor:m,helperManager:p}}exports.getVersion=getVersion,exports.transform=transform,exports.getFormattedTokens=getFormattedTokens;