"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Ignore=void 0;const minimatch_1=require("minimatch"),pattern_js_1=require("./pattern.js"),defaultPlatform="object"==typeof process&&process&&"string"==typeof process.platform?process.platform:"linux";class Ignore{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(t,{nobrace:e,nocase:o,noext:r,noglobstar:s,platform:i=defaultPlatform}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=i,this.mmopts={dot:!0,nobrace:e,nocase:o,noext:r,noglobstar:s,optimizationLevel:2,platform:i,nocomment:!0,nonegate:!0};for(const e of t)this.add(e)}add(t){const e=new minimatch_1.Minimatch(t,this.mmopts);for(let t=0;t<e.set.length;t++){const o=e.set[t],r=e.globParts[t];if(!o||!r)throw new Error("invalid pattern object");for(;"."===o[0]&&"."===r[0];)o.shift(),r.shift();const s=new pattern_js_1.Pattern(o,r,0,this.platform),i=new minimatch_1.Minimatch(s.globString(),this.mmopts),n="**"===r[r.length-1],a=s.isAbsolute();a?this.absolute.push(i):this.relative.push(i),n&&(a?this.absoluteChildren.push(i):this.relativeChildren.push(i))}}ignored(t){const e=t.fullpath(),o=`${e}/`,r=t.relative()||".",s=`${r}/`;for(const t of this.relative)if(t.match(r)||t.match(s))return!0;for(const t of this.absolute)if(t.match(e)||t.match(o))return!0;return!1}childrenIgnored(t){const e=t.fullpath()+"/",o=(t.relative()||".")+"/";for(const t of this.relativeChildren)if(t.match(o))return!0;for(const t of this.absoluteChildren)if(t.match(e))return!0;return!1}}exports.Ignore=Ignore;