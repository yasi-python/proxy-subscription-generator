"use strict";var isGlob=require("is-glob"),pathPosixDirname=require("path").posix.dirname,isWin32="win32"===require("os").platform(),slash="/",backslash=/\\/g,escaped=/\\([!*?|[\](){}])/g;function isEnclosure(s){var e;switch(s.slice(-1)){case"}":e="{";break;case"]":e="[";break;default:return!1}var i=s.indexOf(e);return!(i<0)&&s.slice(i+1,-1).includes(slash)}function isGlobby(s){return!!/\([^()]+$/.test(s)||("{"===s[0]||"["===s[0]||(!!/[^\\][{[]/.test(s)||isGlob(s)))}module.exports=function(s,e){Object.assign({flipBackslashes:!0},e).flipBackslashes&&isWin32&&s.indexOf(slash)<0&&(s=s.replace(backslash,slash)),isEnclosure(s)&&(s+=slash),s+="a";do{s=pathPosixDirname(s)}while(isGlobby(s));return s.replace(escaped,"$1")};