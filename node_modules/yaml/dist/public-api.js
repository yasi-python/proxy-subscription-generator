"use strict";var composer=require("./compose/composer.js"),Document=require("./doc/Document.js"),errors=require("./errors.js"),log=require("./log.js"),identity=require("./nodes/identity.js"),lineCounter=require("./parse/line-counter.js"),parser=require("./parse/parser.js");function parseOptions(r){const e=!1!==r.prettyErrors;return{lineCounter:r.lineCounter||e&&new lineCounter.LineCounter||null,prettyErrors:e}}function parseAllDocuments(r,e={}){const{lineCounter:o,prettyErrors:n}=parseOptions(e),t=new parser.Parser(o?.addNewLine),s=new composer.Composer(e),i=Array.from(s.compose(t.parse(r)));if(n&&o)for(const e of i)e.errors.forEach(errors.prettifyError(r,o)),e.warnings.forEach(errors.prettifyError(r,o));return i.length>0?i:Object.assign([],{empty:!0},s.streamInfo())}function parseDocument(r,e={}){const{lineCounter:o,prettyErrors:n}=parseOptions(e),t=new parser.Parser(o?.addNewLine),s=new composer.Composer(e);let i=null;for(const e of s.compose(t.parse(r),!0,r.length))if(i){if("silent"!==i.options.logLevel){i.errors.push(new errors.YAMLParseError(e.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else i=e;return n&&o&&(i.errors.forEach(errors.prettifyError(r,o)),i.warnings.forEach(errors.prettifyError(r,o))),i}function parse(r,e,o){let n;"function"==typeof e?n=e:void 0===o&&e&&"object"==typeof e&&(o=e);const t=parseDocument(r,o);if(!t)return null;if(t.warnings.forEach(r=>log.warn(t.options.logLevel,r)),t.errors.length>0){if("silent"!==t.options.logLevel)throw t.errors[0];t.errors=[]}return t.toJS(Object.assign({reviver:n},o))}function stringify(r,e,o){let n=null;if("function"==typeof e||Array.isArray(e)?n=e:void 0===o&&e&&(o=e),"string"==typeof o&&(o=o.length),"number"==typeof o){const r=Math.round(o);o=r<1?void 0:r>8?{indent:8}:{indent:r}}if(void 0===r){const{keepUndefined:r}=o??e??{};if(!r)return}return identity.isDocument(r)&&!n?r.toString(o):new Document.Document(r,n,o).toString(o)}exports.parse=parse,exports.parseAllDocuments=parseAllDocuments,exports.parseDocument=parseDocument,exports.stringify=stringify;