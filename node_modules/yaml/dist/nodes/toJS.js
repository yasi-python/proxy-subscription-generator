"use strict";var identity=require("./identity.js");function toJS(t,e,r){if(Array.isArray(t))return t.map((t,e)=>toJS(t,String(e),r));if(t&&"function"==typeof t.toJSON){if(!r||!identity.hasAnchor(t))return t.toJSON(e,r);const n={aliasCount:0,count:1,res:void 0};r.anchors.set(t,n),r.onCreate=t=>{n.res=t,delete r.onCreate};const o=t.toJSON(e,r);return r.onCreate&&r.onCreate(o),o}return"bigint"!=typeof t||r?.keep?t:Number(t)}exports.toJS=toJS;