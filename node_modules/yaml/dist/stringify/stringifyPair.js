"use strict";var identity=require("../nodes/identity.js"),Scalar=require("../nodes/Scalar.js"),stringify=require("./stringify.js"),stringifyComment=require("./stringifyComment.js");function stringifyPair({key:n,value:e},i,t,l){const{allNullValues:o,doc:r,indent:s,indentStep:a,options:{commentString:m,indentSeq:y,simpleKeys:f}}=i;let c=identity.isNode(n)&&n.comment||null;if(f){if(c)throw new Error("With simple keys, key nodes cannot have comments");if(identity.isCollection(n)||!identity.isNode(n)&&"object"==typeof n){throw new Error("With simple keys, collection cannot be used as a key value")}}let d=!f&&(!n||c&&null==e&&!i.inFlow||identity.isCollection(n)||(identity.isScalar(n)?n.type===Scalar.Scalar.BLOCK_FOLDED||n.type===Scalar.Scalar.BLOCK_LITERAL:"object"==typeof n));i=Object.assign({},i,{allNullValues:!1,implicitKey:!d&&(f||!o),indent:s+a});let g,u,C,p=!1,w=!1,h=stringify.stringify(n,i,()=>p=!0,()=>w=!0);if(!d&&!i.inFlow&&h.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");d=!0}if(i.inFlow){if(o||null==e)return p&&t&&t(),""===h?"?":d?`? ${h}`:h}else if(o&&!f||null==e&&d)return h=`? ${h}`,c&&!p?h+=stringifyComment.lineComment(h,i.indent,m(c)):w&&l&&l(),h;p&&(c=null),d?(c&&(h+=stringifyComment.lineComment(h,i.indent,m(c))),h=`? ${h}\n${s}:`):(h=`${h}:`,c&&(h+=stringifyComment.lineComment(h,i.indent,m(c)))),identity.isNode(e)?(g=!!e.spaceBefore,u=e.commentBefore,C=e.comment):(g=!1,u=null,C=null,e&&"object"==typeof e&&(e=r.createNode(e))),i.implicitKey=!1,d||c||!identity.isScalar(e)||(i.indentAtStart=h.length+1),w=!1,y||!(a.length>=2)||i.inFlow||d||!identity.isSeq(e)||e.flow||e.tag||e.anchor||(i.indent=i.indent.substring(2));let S=!1;const j=stringify.stringify(e,i,()=>S=!0,()=>w=!0);let F=" ";if(c||g||u){if(F=g?"\n":"",u){const n=m(u);F+=`\n${stringifyComment.indentComment(n,i.indent)}`}""!==j||i.inFlow?F+=`\n${i.indent}`:"\n"===F&&(F="\n\n")}else if(!d&&identity.isCollection(e)){const n=j[0],t=j.indexOf("\n"),l=-1!==t,o=i.inFlow??e.flow??0===e.items.length;if(l||!o){let e=!1;if(l&&("&"===n||"!"===n)){let i=j.indexOf(" ");"&"===n&&-1!==i&&i<t&&"!"===j[i+1]&&(i=j.indexOf(" ",i+1)),(-1===i||t<i)&&(e=!0)}e||(F=`\n${i.indent}`)}}else""!==j&&"\n"!==j[0]||(F="");return h+=F+j,i.inFlow?S&&t&&t():C&&!S?h+=stringifyComment.lineComment(h,i.indent,m(C)):w&&l&&l(),h}exports.stringifyPair=stringifyPair;