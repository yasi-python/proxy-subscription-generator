"use strict";const FOLD_FLOW="flow",FOLD_BLOCK="block",FOLD_QUOTED="quoted";function foldFlowLines(e,t,n="flow",{indentAtStart:o,lineWidth:l=80,minContentWidth:s=20,onFold:i,onOverflow:r}={}){if(!l||l<0)return e;l<s&&(s=0);const f=Math.max(1+s,1+l-t.length);if(e.length<=f)return e;const c=[],d={};let u,h,L=l-t.length;"number"==typeof o&&(o>l-Math.max(2,s)?c.push(0):L=l-o);let O=!1,a=-1,F=-1,g=-1;"block"===n&&(a=consumeMoreIndentedLines(e,a,t.length),-1!==a&&(L=a+f));for(let o;o=e[a+=1];){if("quoted"===n&&"\\"===o){switch(F=a,e[a+1]){case"x":a+=3;break;case"u":a+=5;break;case"U":a+=9;break;default:a+=1}g=a}if("\n"===o)"block"===n&&(a=consumeMoreIndentedLines(e,a,t.length)),L=a+t.length+f,u=void 0;else{if(" "===o&&h&&" "!==h&&"\n"!==h&&"\t"!==h){const t=e[a+1];t&&" "!==t&&"\n"!==t&&"\t"!==t&&(u=a)}if(a>=L)if(u)c.push(u),L=u+f,u=void 0;else if("quoted"===n){for(;" "===h||"\t"===h;)h=o,o=e[a+=1],O=!0;const t=a>g+1?a-2:F-1;if(d[t])return e;c.push(t),d[t]=!0,L=t+f,u=void 0}else O=!0}h=o}if(O&&r&&r(),0===c.length)return e;i&&i();let w=e.slice(0,c[0]);for(let o=0;o<c.length;++o){const l=c[o],s=c[o+1]||e.length;0===l?w=`\n${t}${e.slice(0,s)}`:("quoted"===n&&d[l]&&(w+=`${e[l]}\\`),w+=`\n${t}${e.slice(l+1,s)}`)}return w}function consumeMoreIndentedLines(e,t,n){let o=t,l=t+1,s=e[l];for(;" "===s||"\t"===s;)if(t<l+n)s=e[++t];else{do{s=e[++t]}while(s&&"\n"!==s);o=t,l=t+1,s=e[l]}return o}exports.FOLD_BLOCK="block",exports.FOLD_FLOW="flow",exports.FOLD_QUOTED="quoted",exports.foldFlowLines=foldFlowLines;