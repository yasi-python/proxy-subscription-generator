const FOLD_FLOW="flow",FOLD_BLOCK="block",FOLD_QUOTED="quoted";function foldFlowLines(e,n,t="flow",{indentAtStart:o,lineWidth:l=80,minContentWidth:i=20,onFold:s,onOverflow:r}={}){if(!l||l<0)return e;l<i&&(i=0);const f=Math.max(1+i,1+l-n.length);if(e.length<=f)return e;const c=[],d={};let u,h,L=l-n.length;"number"==typeof o&&(o>l-Math.max(2,i)?c.push(0):L=l-o);let O=!1,a=-1,F=-1,g=-1;"block"===t&&(a=consumeMoreIndentedLines(e,a,n.length),-1!==a&&(L=a+f));for(let o;o=e[a+=1];){if("quoted"===t&&"\\"===o){switch(F=a,e[a+1]){case"x":a+=3;break;case"u":a+=5;break;case"U":a+=9;break;default:a+=1}g=a}if("\n"===o)"block"===t&&(a=consumeMoreIndentedLines(e,a,n.length)),L=a+n.length+f,u=void 0;else{if(" "===o&&h&&" "!==h&&"\n"!==h&&"\t"!==h){const n=e[a+1];n&&" "!==n&&"\n"!==n&&"\t"!==n&&(u=a)}if(a>=L)if(u)c.push(u),L=u+f,u=void 0;else if("quoted"===t){for(;" "===h||"\t"===h;)h=o,o=e[a+=1],O=!0;const n=a>g+1?a-2:F-1;if(d[n])return e;c.push(n),d[n]=!0,L=n+f,u=void 0}else O=!0}h=o}if(O&&r&&r(),0===c.length)return e;s&&s();let D=e.slice(0,c[0]);for(let o=0;o<c.length;++o){const l=c[o],i=c[o+1]||e.length;0===l?D=`\n${n}${e.slice(0,i)}`:("quoted"===t&&d[l]&&(D+=`${e[l]}\\`),D+=`\n${n}${e.slice(l+1,i)}`)}return D}function consumeMoreIndentedLines(e,n,t){let o=n,l=n+1,i=e[l];for(;" "===i||"\t"===i;)if(n<l+t)i=e[++n];else{do{i=e[++n]}while(i&&"\n"!==i);o=n,l=n+1,i=e[l]}return o}export{FOLD_BLOCK,FOLD_FLOW,FOLD_QUOTED,foldFlowLines};