import{stringifyNumber}from"../../stringify/stringifyNumber.js";function parseSexagesimal(t,e){const i=t[0],a="-"===i||"+"===i?t.substring(1):t,s=t=>e?BigInt(t):Number(t),r=a.replace(/_/g,"").split(":").reduce((t,e)=>t*s(60)+s(e),s(0));return"-"===i?s(-1)*r:r}function stringifySexagesimal(t){let{value:e}=t,i=t=>t;if("bigint"==typeof e)i=t=>BigInt(t);else if(isNaN(e)||!isFinite(e))return stringifyNumber(t);let a="";e<0&&(a="-",e*=i(-1));const s=i(60),r=[e%s];return e<60?r.unshift(0):(e=(e-r[0])/s,r.unshift(e%s),e>=60&&(e=(e-r[0])/s,r.unshift(e))),a+r.map(t=>String(t).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const intTime={identify:t=>"bigint"==typeof t||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:i})=>parseSexagesimal(t,i),stringify:stringifySexagesimal},floatTime={identify:t=>"number"==typeof t,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>parseSexagesimal(t,!1),stringify:stringifySexagesimal},timestamp={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const e=t.match(timestamp.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,i,a,s,r,n,m]=e.map(Number),g=e[7]?Number((e[7]+"00").substr(1,3)):0;let f=Date.UTC(i,a-1,s,r||0,n||0,m||0,g);const l=e[8];if(l&&"Z"!==l){let t=parseSexagesimal(l,!1);Math.abs(t)<30&&(t*=60),f-=6e4*t}return new Date(f)},stringify:({value:t})=>t?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""};export{floatTime,intTime,timestamp};