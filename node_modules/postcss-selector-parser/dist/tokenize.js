"use strict";exports.__esModule=!0,exports.FIELDS=void 0,exports.default=tokenize;var _unescapable,_wordDelimiters,t=_interopRequireWildcard(require("./tokenTypes"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_getRequireWildcardCache=function(e){return e?r:t})(e)}function _interopRequireWildcard(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache(t);if(r&&r.has(e))return r.get(e);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=s?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,r&&r.set(e,a),a}for(var unescapable=((_unescapable={})[t.tab]=!0,_unescapable[t.newline]=!0,_unescapable[t.cr]=!0,_unescapable[t.feed]=!0,_unescapable),wordDelimiters=((_wordDelimiters={})[t.space]=!0,_wordDelimiters[t.tab]=!0,_wordDelimiters[t.newline]=!0,_wordDelimiters[t.cr]=!0,_wordDelimiters[t.feed]=!0,_wordDelimiters[t.ampersand]=!0,_wordDelimiters[t.asterisk]=!0,_wordDelimiters[t.bang]=!0,_wordDelimiters[t.comma]=!0,_wordDelimiters[t.colon]=!0,_wordDelimiters[t.semicolon]=!0,_wordDelimiters[t.openParenthesis]=!0,_wordDelimiters[t.closeParenthesis]=!0,_wordDelimiters[t.openSquare]=!0,_wordDelimiters[t.closeSquare]=!0,_wordDelimiters[t.singleQuote]=!0,_wordDelimiters[t.doubleQuote]=!0,_wordDelimiters[t.plus]=!0,_wordDelimiters[t.pipe]=!0,_wordDelimiters[t.tilde]=!0,_wordDelimiters[t.greaterThan]=!0,_wordDelimiters[t.equals]=!0,_wordDelimiters[t.dollar]=!0,_wordDelimiters[t.caret]=!0,_wordDelimiters[t.slash]=!0,_wordDelimiters),hex={},hexChars="0123456789abcdefABCDEF",i=0;i<hexChars.length;i++)hex[hexChars.charCodeAt(i)]=!0;function consumeWord(e,r){var a,s=r;do{if(a=e.charCodeAt(s),wordDelimiters[a])return s-1;a===t.backslash?s=consumeEscape(e,s)+1:s++}while(s<e.length);return s-1}function consumeEscape(e,r){var a=r,s=e.charCodeAt(a+1);if(unescapable[s]);else if(hex[s]){var i=0;do{a++,i++,s=e.charCodeAt(a+1)}while(hex[s]&&i<6);i<6&&s===t.space&&a++}else a++;return a}var FIELDS={TYPE:0,START_LINE:1,START_COL:2,END_LINE:3,END_COL:4,START_POS:5,END_POS:6};function tokenize(e){var r,a,s,i,o,l,c,n,d,u,p,h,w=[],_=e.css.valueOf(),m=_.length,f=-1,D=1,b=0,g=0;function C(t,r){if(!e.safe)throw e.error("Unclosed "+t,D,b-f,b);n=(_+=r).length-1}for(;b<m;){switch((r=_.charCodeAt(b))===t.newline&&(f=b,D+=1),r){case t.space:case t.tab:case t.newline:case t.cr:case t.feed:n=b;do{n+=1,(r=_.charCodeAt(n))===t.newline&&(f=n,D+=1)}while(r===t.space||r===t.newline||r===t.tab||r===t.cr||r===t.feed);h=t.space,s=D,a=n-f-1,g=n;break;case t.plus:case t.greaterThan:case t.tilde:case t.pipe:n=b;do{n+=1,r=_.charCodeAt(n)}while(r===t.plus||r===t.greaterThan||r===t.tilde||r===t.pipe);h=t.combinator,s=D,a=b-f,g=n;break;case t.asterisk:case t.ampersand:case t.bang:case t.comma:case t.equals:case t.dollar:case t.caret:case t.openSquare:case t.closeSquare:case t.colon:case t.semicolon:case t.openParenthesis:case t.closeParenthesis:h=r,s=D,a=b-f,g=(n=b)+1;break;case t.singleQuote:case t.doubleQuote:p=r===t.singleQuote?"'":'"',n=b;do{for(i=!1,-1===(n=_.indexOf(p,n+1))&&C("quote",p),o=n;_.charCodeAt(o-1)===t.backslash;)o-=1,i=!i}while(i);h=t.str,s=D,a=b-f,g=n+1;break;default:r===t.slash&&_.charCodeAt(b+1)===t.asterisk?(0===(n=_.indexOf("*/",b+2)+1)&&C("comment","*/"),(l=(c=_.slice(b,n+1).split("\n")).length-1)>0?(d=D+l,u=n-c[l].length):(d=D,u=f),h=t.comment,D=d,s=d,a=n-u):r===t.slash?(h=r,s=D,a=b-f,g=(n=b)+1):(n=consumeWord(_,b),h=t.word,s=D,a=n-f),g=n+1}w.push([h,D,b-f,s,a,b,g]),u&&(f=u,u=null),b=g}return w}exports.FIELDS=FIELDS;