import fs from"fs";import path from"path";let jsExtensions=[".js",".cjs",".mjs"],jsResolutionOrder=["",".js",".cjs",".mjs",".ts",".cts",".mts",".jsx",".tsx"],tsResolutionOrder=["",".ts",".cts",".mts",".tsx",".js",".cjs",".mjs",".jsx"];function resolveWithExtension(e,t){for(let s of t){let t=`${e}${s}`;if(fs.existsSync(t)&&fs.statSync(t).isFile())return t}for(let s of t){let t=`${e}/index${s}`;if(fs.existsSync(t))return t}return null}function*_getModuleDependencies(e,t,s,n=path.extname(e)){let i=resolveWithExtension(path.resolve(t,e),jsExtensions.includes(n)?jsResolutionOrder:tsResolutionOrder);if(null===i)return;if(s.has(i))return;s.add(i),yield i,t=path.dirname(i),n=path.extname(i);let r=fs.readFileSync(i,"utf-8");for(let e of[...r.matchAll(/import[\s\S]*?['"](.{3,}?)['"]/gi),...r.matchAll(/import[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi),...r.matchAll(/require\(['"`](.+)['"`]\)/gi)])e[1].startsWith(".")&&(yield*_getModuleDependencies(e[1],t,s,n))}export default function getModuleDependencies(e){return null===e?new Set:new Set(_getModuleDependencies(e,path.dirname(e),new Set))}