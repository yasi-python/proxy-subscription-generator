import postcss from"postcss";import postcssNested from"postcss-nested";export function nesting(s=postcssNested){return(e,t)=>{e.walkAtRules("screen",s=>{s.name="media",s.params=`screen(${s.params})`}),e.walkAtRules("apply",s=>{s.before(postcss.decl({prop:"__apply",value:s.params,source:s.source})),s.remove()});let r=(()=>{if("function"==typeof s||"object"==typeof s&&s?.hasOwnProperty?.("postcssPlugin"))return s;if("string"==typeof s)return require(s);if(Object.keys(s).length<=0)return postcssNested;throw new Error("tailwindcss/nesting should be loaded with a nesting plugin.")})();return postcss([r]).process(e,t.opts).sync(),e.walkDecls("__apply",s=>{s.before(postcss.atRule({name:"apply",params:s.value,source:s.source})),s.remove()}),function s(e){"markDirty"in e&&(e.nodes&&e.nodes.forEach(e=>s(e)),e.nodes||e.markDirty())}(e),e}}