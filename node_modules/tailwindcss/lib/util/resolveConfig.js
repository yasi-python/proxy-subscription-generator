"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return resolveConfig}});const _negateValue=_interop_require_default(require("./negateValue")),_corePluginList=_interop_require_default(require("../corePluginList")),_configurePlugins=_interop_require_default(require("./configurePlugins")),_colors=_interop_require_default(require("../public/colors")),_defaults=require("./defaults"),_toPath=require("./toPath"),_normalizeConfig=require("./normalizeConfig"),_isPlainObject=_interop_require_default(require("./isPlainObject")),_cloneDeep=require("./cloneDeep"),_pluginUtils=require("./pluginUtils"),_withAlphaVariable=require("./withAlphaVariable"),_toColorValue=_interop_require_default(require("./toColorValue"));function _interop_require_default(e){return e&&e.__esModule?e:{default:e}}function isFunction(e){return"function"==typeof e}function mergeWith(e,...t){let i=t.pop();for(let r of t)for(let t in r){let n=i(e[t],r[t]);void 0===n?(0,_isPlainObject.default)(e[t])&&(0,_isPlainObject.default)(r[t])?e[t]=mergeWith({},e[t],r[t],i):e[t]=r[t]:e[t]=n}return e}const configUtils={colors:_colors.default,negative:e=>Object.keys(e).filter(t=>"0"!==e[t]).reduce((t,i)=>{let r=(0,_negateValue.default)(e[i]);return void 0!==r&&(t[`-${i}`]=r),t},{}),breakpoints:e=>Object.keys(e).filter(t=>"string"==typeof e[t]).reduce((t,i)=>({...t,[`screen-${i}`]:e[i]}),{})};function value(e,...t){return isFunction(e)?e(...t):e}function collectExtends(e){return e.reduce((e,{extend:t})=>mergeWith(e,t,(e,t)=>void 0===e?[t]:Array.isArray(e)?[t,...e]:[t,e]),{})}function mergeThemes(e){return{...e.reduce((e,t)=>(0,_defaults.defaults)(e,t),{}),extend:collectExtends(e)}}function mergeExtensionCustomizer(e,t){return Array.isArray(e)&&(0,_isPlainObject.default)(e[0])?e.concat(t):Array.isArray(t)&&(0,_isPlainObject.default)(t[0])&&(0,_isPlainObject.default)(e)?[e,...t]:Array.isArray(t)?t:void 0}function mergeExtensions({extend:e,...t}){return mergeWith(t,e,(e,t)=>isFunction(e)||t.some(isFunction)?(i,r)=>mergeWith({},...[e,...t].map(e=>value(e,i,r)),mergeExtensionCustomizer):mergeWith({},e,...t,mergeExtensionCustomizer))}function*toPaths(e){let t=(0,_toPath.toPath)(e);if(0===t.length)return;if(yield t,Array.isArray(e))return;let i=e.match(/^(.*?)\s*\/\s*([^/]+)$/);if(null!==i){let[,e,t]=i,r=(0,_toPath.toPath)(e);r.alpha=t,yield r}}function resolveFunctionKeys(e){const t=(i,r)=>{for(const r of toPaths(i)){let i=0,n=e;for(;null!=n&&i<r.length;)n=n[r[i++]],n=isFunction(n)&&(void 0===r.alpha||i<=r.length-1)?n(t,configUtils):n;if(void 0!==n){if(void 0!==r.alpha){let e=(0,_pluginUtils.parseColorFormat)(n);return(0,_withAlphaVariable.withAlphaValue)(e,r.alpha,(0,_toColorValue.default)(e))}return(0,_isPlainObject.default)(n)?(0,_cloneDeep.cloneDeep)(n):n}}return r};return Object.assign(t,{theme:t,...configUtils}),Object.keys(e).reduce((i,r)=>(i[r]=isFunction(e[r])?e[r](t,configUtils):e[r],i),{})}function extractPluginConfigs(e){let t=[];return e.forEach(e=>{var i;t=[...t,e];const r=null!==(i=null==e?void 0:e.plugins)&&void 0!==i?i:[];0!==r.length&&r.forEach(e=>{var i;e.__isOptionsFunction&&(e=e()),t=[...t,...extractPluginConfigs([null!==(i=null==e?void 0:e.config)&&void 0!==i?i:{}])]})}),t}function resolveCorePlugins(e){return[...e].reduceRight((e,t)=>isFunction(t)?t({corePlugins:e}):(0,_configurePlugins.default)(t,e),_corePluginList.default)}function resolvePluginLists(e){return[...e].reduceRight((e,t)=>[...e,...t],[])}function resolveConfig(e){let t=[...extractPluginConfigs(e),{prefix:"",important:!1,separator:":"}];var i,r;return(0,_normalizeConfig.normalizeConfig)((0,_defaults.defaults)({theme:resolveFunctionKeys(mergeExtensions(mergeThemes(t.map(e=>null!==(i=null==e?void 0:e.theme)&&void 0!==i?i:{})))),corePlugins:resolveCorePlugins(t.map(e=>e.corePlugins)),plugins:resolvePluginLists(e.map(e=>null!==(r=null==e?void 0:e.plugins)&&void 0!==r?r:[]))},...t))}