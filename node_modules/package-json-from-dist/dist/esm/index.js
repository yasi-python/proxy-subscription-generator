import{readFileSync}from"node:fs";import{dirname,resolve,sep}from"node:path";import{fileURLToPath}from"node:url";const NM=`${sep}node_modules${sep}`,STORE=`.store${sep}`,PKG=`${sep}package${sep}`,DIST=`${sep}dist${sep}`;export const findPackageJson=(e,s="../package.json")=>{const t="object"==typeof e||e.startsWith("file://")?fileURLToPath(e):e,n=dirname(t),o=n.lastIndexOf(NM);if(-1!==o){const e=n.substring(0,o+NM.length),s=n.substring(o+NM.length);if(s.startsWith(STORE)){const t=s.indexOf(PKG,STORE.length);if(t)return resolve(e,s.substring(0,t+PKG.length),"package.json")}const t=s.startsWith("@")?s.split(sep,2).join(sep):String(s.split(sep)[0]);return resolve(e,t,"package.json")}{const e=n.lastIndexOf(DIST);return-1!==e?resolve(n.substring(0,e),"package.json"):resolve(n,s)}};export const loadPackageJson=(e,s="../package.json")=>JSON.parse(readFileSync(findPackageJson(e,s),"utf8"));