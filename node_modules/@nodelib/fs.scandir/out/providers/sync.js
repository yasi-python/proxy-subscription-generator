"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.readdir=exports.readdirWithFileTypes=exports.read=void 0;const fsStat=require("@nodelib/fs.stat"),constants_1=require("../constants"),utils=require("../utils"),common=require("./common");function read(t,e){return!e.stats&&constants_1.IS_SUPPORT_READDIR_WITH_FILE_TYPES?readdirWithFileTypes(t,e):readdir(t,e)}function readdirWithFileTypes(t,e){return e.fs.readdirSync(t,{withFileTypes:!0}).map(r=>{const i={dirent:r,name:r.name,path:common.joinPathSegments(t,r.name,e.pathSegmentSeparator)};if(i.dirent.isSymbolicLink()&&e.followSymbolicLinks)try{const t=e.fs.statSync(i.path);i.dirent=utils.fs.createDirentFromStats(i.name,t)}catch(t){if(e.throwErrorOnBrokenSymbolicLink)throw t}return i})}function readdir(t,e){return e.fs.readdirSync(t).map(r=>{const i=common.joinPathSegments(t,r,e.pathSegmentSeparator),s=fsStat.statSync(i,e.fsStatSettings),n={name:r,path:i,dirent:utils.fs.createDirentFromStats(r,s)};return e.stats&&(n.stats=s),n})}exports.read=read,exports.readdirWithFileTypes=readdirWithFileTypes,exports.readdir=readdir;