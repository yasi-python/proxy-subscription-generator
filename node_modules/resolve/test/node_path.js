var fs=require("fs"),path=require("path"),test=require("tape"),resolve=require("../");test("$NODE_PATH",function(e){e.plan(8);var a=function(e,a){if("/node_path"===e||"node_path/x"===e)return a(null,!0);fs.stat(e,function(e,r){return e?"ENOENT"===e.code||"ENOTDIR"===e.code?a(null,!1):a(e):a(null,r.isDirectory())})};resolve("aaa",{paths:[path.join(__dirname,"/node_path/x"),path.join(__dirname,"/node_path/y")],basedir:__dirname,isDirectory:a},function(a,r){e.error(a),e.equal(r,path.join(__dirname,"/node_path/x/aaa/index.js"),"aaa resolves")}),resolve("bbb",{paths:[path.join(__dirname,"/node_path/x"),path.join(__dirname,"/node_path/y")],basedir:__dirname,isDirectory:a},function(a,r){e.error(a),e.equal(r,path.join(__dirname,"/node_path/y/bbb/index.js"),"bbb resolves")}),resolve("ccc",{paths:[path.join(__dirname,"/node_path/x"),path.join(__dirname,"/node_path/y")],basedir:__dirname,isDirectory:a},function(a,r){e.error(a),e.equal(r,path.join(__dirname,"/node_path/x/ccc/index.js"),"ccc resolves")}),resolve("tap",{paths:["node_path"],basedir:path.join(__dirname,"node_path/x"),isDirectory:a},function(a,r){var n=require("tap/package.json").main;e.error(a),e.equal(r,path.resolve(__dirname,"..","node_modules/tap",n),"tap resolves")})});