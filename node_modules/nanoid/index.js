import crypto from"crypto";import{urlAlphabet}from"./url-alphabet/index.js";const POOL_SIZE_MULTIPLIER=128;let pool,poolOffset,fillPool=o=>{!pool||pool.length<o?(pool=Buffer.allocUnsafe(128*o),crypto.randomFillSync(pool),poolOffset=0):poolOffset+o>pool.length&&(crypto.randomFillSync(pool),poolOffset=0),poolOffset+=o},random=o=>(fillPool(o|=0),pool.subarray(poolOffset-o,poolOffset)),customRandom=(o,l,t)=>{let e=(2<<31-Math.clz32(o.length-1|1))-1,p=Math.ceil(1.6*e*l/o.length);return(f=l)=>{let r="";for(;;){let l=t(p),n=p;for(;n--;)if(r+=o[l[n]&e]||"",r.length===f)return r}}},customAlphabet=(o,l=21)=>customRandom(o,l,random),nanoid=(o=21)=>{fillPool(o|=0);let l="";for(let t=poolOffset-o;t<poolOffset;t++)l+=urlAlphabet[63&pool[t]];return l};export{nanoid,customAlphabet,customRandom,urlAlphabet,random};