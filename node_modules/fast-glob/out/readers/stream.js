"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const stream_1=require("stream"),fsStat=require("@nodelib/fs.stat"),fsWalk=require("@nodelib/fs.walk"),reader_1=require("./reader");class ReaderStream extends reader_1.default{constructor(){super(...arguments),this._walkStream=fsWalk.walkStream,this._stat=fsStat.stat}dynamic(t,e){return this._walkStream(t,e)}static(t,e){const r=t.map(this._getFullEntryPath,this),s=new stream_1.PassThrough({objectMode:!0});s._write=(a,n,i)=>this._getEntry(r[a],t[a],e).then(t=>{null!==t&&e.entryFilter(t)&&s.push(t),a===r.length-1&&s.end(),i()}).catch(i);for(let t=0;t<r.length;t++)s.write(t);return s}_getEntry(t,e,r){return this._getStat(t).then(t=>this._makeEntry(t,e)).catch(t=>{if(r.errorFilter(t))return null;throw t})}_getStat(t){return new Promise((e,r)=>{this._stat(t,this._fsStatSettings,(t,s)=>null===t?e(s):r(t))})}}exports.default=ReaderStream;